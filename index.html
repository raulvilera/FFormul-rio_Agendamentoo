<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema de Gestão de Equipamentos Tecnológicos</title>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
  
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <style>
    /* ==== VARIÁVEIS DE CORES ==== */
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #34495e;
      --accent-color: #3498db;
      --success-color: #27ae60;
      --warning-color: #f39c12;
      --danger-color: #e74c3c;
      --info-color: #2980b9;
      --light-color: #ecf0f1;
      --dark-color: #2c3e50;
      --white: #ffffff;
      --gray-light: #bdc3c7;
      --gray-medium: #95a5a6;
      --gray-dark: #7f8c8d;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --border-radius: 8px;
      --transition: all 0.3s ease;
    }

    /* ===== ESTILOS GERAIS ===== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background-color: #fff7fa;
      color: var(--dark-color);
      line-height: 1.6;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    /* ===== CABEÇALHO ===== */
    header {
      background-color: var(--primary-color);
      color: var(--white);
      padding: 20px 0;
      box-shadow: var(--shadow);
      margin-bottom: 30px;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .logo {
      font-size: 24px;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logout-btn {
      background-color: var(--danger-color);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: var(--border-radius);
      cursor: pointer;
      transition: var(--transition);
    }

    .logout-btn:hover {
      background-color: #c0392b;
    }

    /* ==== NAVEGAÇÃO ==== */
    .nav-tabs {
      display: flex;
      background-color: var(--secondary-color);
      border-radius: var(--border-radius);
      overflow: hidden;
      margin-bottom: 30px;
    }

    .nav-tab {
      padding: 15px 25px;
      color: var(--white);
      text-decoration: none;
      font-weight: 500;
      transition: var(--transition);
      cursor: pointer;
      text-align: center;
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .nav-tab:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }

    .nav-tab.active {
      background-color: var(--accent-color);
    }

    /* ==== CONTEÚDO DAS ABAS ==== */
    .tab-content {
      display: none;
      background-color: var(--white);
      padding: 25px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      margin-bottom: 30px;
    }

    .tab-content.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ==== FORMULÁRIOS ==== */
    .form-title {
      margin-bottom: 20px;
      color: var(--primary-color);
      font-size: 22px;
      border-bottom: 2px solid var(--accent-color);
      padding-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--secondary-color);
    }

    .form-control {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid var(--gray-light);
      border-radius: var(--border-radius);
      font-size: 16px;
      transition: var(--transition);
    }

    .form-control:focus {
      border-color: var(--accent-color);
      outline: none;
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
    }

    select.form-control {
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 10px center;
      background-size: 15px;
    }

    .btn {
      padding: 12px 25px;
      border: none;
      border-radius: var(--border-radius);
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      font-size: 16px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn-primary {
      background-color: var(--accent-color);
      color: white;
    }

    .btn-primary:hover {
      background-color: #2980b9;
    }

    .btn-secondary {
      background-color: var(--gray-medium);
      color: white;
    }

    .btn-secondary:hover {
      background-color: var(--gray-dark);
    }

    .btn-success {
      background-color: var(--success-color);
      color: white;
    }

    .btn-success:hover {
      background-color: #219653;
    }

    .btn-danger {
      background-color: var(--danger-color);
      color: white;
    }

    .btn-danger:hover {
      background-color: #c0392b;
    }

    .btn-group {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    /* ===== TABELAS ===== */
    .table-responsive {
      overflow-x: auto;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    .data-table th,
    .data-table td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid var(--gray-light);
    }

    .data-table th {
      background-color: var(--secondary-color);
      color: var(--white);
      font-weight: 500;
      text-transform: uppercase;
      font-size: 14px;
    }

    .data-table tr:hover {
      background-color: rgba(52, 152, 219, 0.05);
    }

    .badge {
      display: inline-block;
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
    }

    .badge-primary {
      background-color: var(--accent-color);
      color: white;
    }

    .badge-success {
      background-color: var(--success-color);
      color: white;
    }

    .badge-warning {
      background-color: var(--warning-color);
      color: white;
    }

    .badge-danger {
      background-color: var(--danger-color);
      color: white;
    }

    .badge-info {
      background-color: var(--info-color);
      color: white;
    }

    /* ==== CARDS DE DASHBOARD ==== */
    .dashboard-cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .card {
      background-color: var(--white);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      padding: 20px;
      transition: var(--transition);
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .card-title {
      font-size: 16px;
      color: var(--secondary-color);
      font-weight: 500;
    }

    .card-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }

    .card-icon.primary {
      background-color: var(--accent-color);
    }

    .card-icon.success {
      background-color: var(--success-color);
    }

    .card-icon.warning {
      background-color: var(--warning-color);
    }

    .card-icon.danger {
      background-color: var(--danger-color);
    }

    .card-body {
      font-size: 28px;
      font-weight: bold;
      color: var(--primary-color);
    }

    /* ==== GRÁFICOS ==== */
    .chart-container {
      background-color: var(--white);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      padding: 20px;
      margin-bottom: 30px;
      height: 400px;
    }

    /* ==== MODAIS ==== */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background-color: var(--white);
      border-radius: var(--border-radius);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      width: 90%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      animation: modalFadeIn 0.3s ease;
    }

    @keyframes modalFadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .modal-header {
      padding: 20px;
      border-bottom: 1px solid var(--gray-light);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-title {
      font-size: 20px;
      color: var(--primary-color);
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--gray-medium);
    }

    .modal-body {
      padding: 20px;
    }

    .modal-footer {
      padding: 20px;
      border-top: 1px solid var(--gray-light);
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    /* ==== RESPONSIVIDADE ==== */
    @media (max-width: 768px) {
      .nav-tabs {
        flex-wrap: wrap;
      }

      .nav-tab {
        flex: 1 0 33%;
        padding: 12px 5px;
        font-size: 14px;
      }

      .form-grid {
        grid-template-columns: 1fr;
      }

      .btn-group {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }
    }

    /* ===== ESTILOS PARA A PÁGINA DE AGENDAMENTO ===== */
    .agendamento-container {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .agendamento-row {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 15px;
    }

    .agendamento-group {
      flex: 1;
      min-width: 200px;
    }

    .datepicker-container {
      position: relative;
    }

    .datepicker-popup {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      z-index: 1000;
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
      width: 300px;
    }

    .datepicker-popup.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    .datepicker-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .datepicker-nav {
      background: none;
      border: none;
      font-size: 1.4rem;
      cursor: pointer;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s;
      color: var(--azul-escuro);
    }

    .datepicker-nav:hover {
      background-color: #d6eaff;
    }

    .datepicker-title {
      font-weight: 600;
      color: var(--primary-color);
      font-size: 1.1rem;
    }

    .datepicker-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }

    .datepicker-weekday {
      text-align: center;
      font-weight: 600;
      padding: 8px 0;
      color: var(--primary-color);
      font-size: 0.9rem;
    }

    .datepicker-day {
      text-align: center;
      padding: 8px 0;
      cursor: pointer;
      border-radius: 50%;
      transition: all 0.2s;
      font-weight: 500;
    }

    .datepicker-day:hover {
      background-color: #d6eaff;
    }

    .datepicker-day.selected {
      background-color: var(--accent-color);
      color: white;
      font-weight: 600;
    }

    .datepicker-day.disabled {
      color: #ccc;
      cursor: not-allowed;
    }

    .datepicker-day.today {
      position: relative;
      color: var(--accent-color);
      font-weight: 700;
    }

    .datepicker-day.today::after {
      content: '';
      position: absolute;
      bottom: 4px;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 4px;
      background-color: var(--accent-color);
      border-radius: 50%;
    }

    .datepicker-day.other-month {
      color: #aaa;
    }

    .datepicker-input {
      cursor: pointer;
      background-color: #f0f0f0;
    }

    .conflict-message {
      color: var(--danger-color);
      font-weight: bold;
      margin-top: 15px;
      text-align: center;
      display: none;
      padding: 10px;
      background-color: #ffebee;
      border-radius: 5px;
      border-left: 4px solid var(--danger-color);
    }

    .legend-container {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 15px 0;
      flex-wrap: wrap;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 0.85rem;
    }

    .status-indicator {
      display: inline-block;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      margin-right: 5px;
    }

    .status-disponivel {
      background-color: var(--success-color);
    }

    .status-agendado {
      background-color: var(--accent-color);
    }

    .status-entregue {
      background-color: var(--success-color);
    }

    .status-excluido {
      background-color: var(--danger-color);
    }

    .aula-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }

    .aula-checkbox {
      display: none;
    }

    .aula-label {
      display: inline-block;
      padding: 8px 15px;
      border: 2px solid #ddd;
      border-radius: 8px;
      cursor: pointer;
      background-color: #f9f9f9;
      transition: all 0.3s;
      font-size: 0.9rem;
    }

    .aula-checkbox:checked + .aula-label {
      background-color: var(--accent-color);
      color: white;
      border-color: var(--accent-color);
    }

    .aula-professor {
      background-color: #fff176;
    }

    .aula-disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* ==== ESTILOS PARA O FILTRO DE EQUIPAMENTOS ==== */
    .filter-container {
      background-color: var(--white);
      padding: 15px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      margin-bottom: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }

    .filter-group {
      flex: 1;
      min-width: 200px;
    }

    /* ==== ESTILOS PARA O STATUS DOS EQUIPAMENTOS ==== */
    .status-available {
      background-color: var(--success-color);
    }

    .status-inuse {
      background-color: var(--accent-color);
    }

    .status-maintenance {
      background-color: var(--warning-color);
    }

    .status-damaged {
      background-color: var(--danger-color);
    }

    .status-unused {
      background-color: var(--gray-medium);
    }
  </style>
</head>
<body>
  <!-- Tela de Login -->
  <div id="loginScreen" class="container" style="max-width: 500px; margin-top: 100px;">
    <div class="card" style="text-align: center;">
      <h2 style="margin-bottom: 30px; color: var(--primary-color);">Sistema de Gestão de Equipamentos</h2>
      <div class="form-group">
        <label for="loginEmail">E-mail Institucional</label>
        <input type="email" id="loginEmail" class="form-control" placeholder="seu.email@escola.gov.br" value="professor@escola.gov.br">
      </div>
      <div class="form-group">
        <label for="loginPassword">Senha</label>
        <input type="password" id="loginPassword" class="form-control" value="senha123">
      </div>
      <div class="btn-group" style="justify-content: center;">
        <button id="loginBtn" class="btn btn-primary" onclick="login()">Entrar</button>
      </div>
    </div>
  </div>

  <!-- Sistema Principal (inicialmente oculto) -->
  <div id="mainSystem" style="display: none;">
    <header>
      <div class="header-content">
        <div class="logo">
          <i class="fas fa-laptop"></i> Sistema de Gestão de Equipamentos
        </div>
        <div class="user-info">
          <span id="currentUser">Administrador</span>
          <button class="logout-btn" onclick="logout()">Sair</button>
        </div>
      </div>
    </header>
    
    <div class="container">
      <div class="nav-tabs">
        <div class="nav-tab active" onclick="openTab('dashboard')">
          <i class="fas fa-chart-line"></i> Dashboard
        </div>
        <div class="nav-tab" onclick="openTab('register')">
          <i class="fas fa-cubes"></i> Cadastro
        </div>
        <div class="nav-tab" onclick="openTab('reservations')">
          <i class="fas fa-calendar-alt"></i> Reservas
        </div>
        <div class="nav-tab" onclick="openTab('reports')">
          <i class="fas fa-file-alt"></i> Relatórios
        </div>
        <div class="nav-tab" onclick="openTab('maintenance')">
          <i class="fas fa-tools"></i> Manutenção
        </div>
        <div class="nav-tab" onclick="openTab('registration')">
          <i class="fas fa-clipboard-list"></i> Registro
        </div>
      </div>

      <!-- Dashboard -->
      <div id="dashboard" class="tab-content active">
        <h2 class="form-title">Dashboard</h2>
        <div class="filter-container">
          <div class="filter-group">
            <label for="dashboardEquipmentFilter">Filtrar por Equipamento</label>
            <select id="dashboardEquipmentFilter" class="form-control" onchange="updateDashboard()">
              <option value="all">Todos os Equipamentos</option>
              <option value="Notebook do aluno">Notebook do aluno</option>
              <option value="Chromebooks">Chromebooks</option>
              <option value="Smartphone">Smartphone</option>
              <option value="Tablets">Tablets</option>
              <option value="Notebook Ultra">Notebook Ultra</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="dashboardLocationFilter">Filtrar por Local</label>
            <select id="dashboardLocationFilter" class="form-control" onchange="updateDashboard()">
              <option value="all">Todos os Locais</option>
              <option value="Sala dos professores">Sala dos professores</option>
              <option value="Sala de informática">Sala de informática</option>
              <option value="Depósito 1ª andar">Depósito 1ª andar</option>
              <option value="Coordenação">Coordenação</option>
              <option value="Direção">Direção</option>
            </select>
          </div>
        </div>
        
        <div class="dashboard-cards">
          <div class="card">
            <div class="card-header">
              <div class="card-title">Em Uso</div>
              <div class="card-icon primary"><i class="fas fa-laptop"></i></div>
            </div>
            <div class="card-body" id="inUseCount">0</div>
          </div>
          <div class="card">
            <div class="card-header">
              <div class="card-title">Disponíveis</div>
              <div class="card-icon success"><i class="fas fa-check-circle"></i></div>
            </div>
            <div class="card-body" id="availableCount">0</div>
          </div>
          <div class="card">
            <div class="card-header">
              <div class="card-title">Em Manutenção</div>
              <div class="card-icon warning"><i class="fas fa-tools"></i></div>
            </div>
            <div class="card-body" id="maintenanceCount">0</div>
          </div>
          <div class="card">
            <div class="card-header">
              <div class="card-title">Com Avarias</div>
              <div class="card-icon danger"><i class="fas fa-exclamation-triangle"></i></div>
            </div>
            <div class="card-body" id="damagedCount">0</div>
          </div>
        </div>
        
        <div class="chart-container">
          <canvas id="equipmentStatusChart"></canvas>
        </div>
        
        <div>
          <h3 style="margin-bottom: 15px;">Últimos Registros</h3>
          <div class="table-responsive">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Data</th>
                  <th>Equipamento</th>
                  <th>Nº Série</th>
                  <th>Local</th>
                  <th>Status</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody id="recentActivitiesTable">
                <!-- Preenchido dinamicamente -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Cadastro de Equipamentos -->
      <div id="register" class="tab-content">
        <h2 class="form-title">Cadastro de Equipamentos</h2>
        <div class="filter-container">
          <div class="filter-group">
            <label for="equipmentSearch">Pesquisar</label>
            <input type="text" id="equipmentSearch" class="form-control" placeholder="Digite para pesquisar..." onkeyup="searchEquipment()">
          </div>
          <div class="filter-group">
            <label for="filterStatus">Status</label>
            <select id="filterStatus" class="form-control" onChange="filterEquipment()">
              <option value="all">Todos</option>
              <option value="Disponível">Disponível</option>
              <option value="Em uso">Em uso</option>
              <option value="Manutenção">Manutenção</option>
              <option value="Com avarias">Com avarias</option>
              <option value="Desuso">Desuso</option>
            </select>
          </div>
          <div class="filter-group">
            <label>&nbsp;</label>
            <button class="btn btn-primary" onclick="showAddEquipmentModal()">
              <i class="fas fa-plus"></i> Novo Equipamento
            </button>
          </div>
        </div>
        <div class="table-responsive">
          <table class="data-table">
            <thead>
              <tr>
                <th>Data Registro</th>
                <th>Nº de Série</th>
                <th>Nº Registro</th>
                <th>Equipamento</th>
                <th>Local</th>
                <th>Quantidade</th>
                <th>Status</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody id="equipmentTable">
              <!-- Preenchido dinamicamente -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Reservas -->
      <div id="reservations" class="tab-content">
        <h2 class="form-title">Gestão de Reservas</h2>
        
        <div class="btn-group">
          <button class="btn btn-primary" onclick="showNewReservationModal()">
            <i class="fas fa-calendar-plus"></i> Nova Reserva
          </button>
          <button class="btn btn-secondary" onclick="refreshReservations()">
            <i class="fas fa-sync-alt"></i> Atualizar
          </button>
        </div>
        
        <div class="table-responsive" style="margin-top: 20px;">
          <table class="data-table">
            <thead>
              <tr>
                <th>Data</th>
                <th>Professor</th>
                <th>Equipamento</th>
                <th>Quantidade</th>
                <th>Local</th>
                <th>Status</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody id="reservationsTable">
              <!-- Preenchido dinamicamente -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Relatórios -->
      <div id="reports" class="tab-content">
        <h2 class="form-title">Relatórios de Equipamentos</h2>
        <div class="filter-container">
          <div class="filter-group">
            <label for="reportType">Tipo de Relatório</label>
            <select id="reportType" class="form-control" onchange="generateReport()">
              <option value="classification">Classificação por Tipo</option>
              <option value="status">Status dos Equipamentos</option>
              <option value="location">Distribuição por Local</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="reportDate">Período</label>
            <select id="reportDate" class="form-control" onchange="generateReport()">
              <option value="all">Todos</option>
              <option value="today">Hoje</option>
              <option value="week">Esta semana</option>
              <option value="month">Este mês</option>
              <option value="year">Este ano</option>
              <option value="custom">Personalizado</option>
            </select>
          </div>
          <div class="filter-group" id="customDateRange" style="display: none;">
            <label for="startDate">De</label>
            <input type="date" id="startDate" class="form-control">
            <label for="endDate">Até</label>
            <input type="date" id="endDate" class="form-control">
          </div>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" onclick="generateReport()">
            <i class="fas fa-file-alt"></i> Gerar Relatório
          </button>
          <button class="btn btn-success" onclick="exportReport()">
            <i class="fas fa-file-export"></i> Exportar
          </button>
          <button class="btn btn-secondary" onclick="printReport()">
            <i class="fas fa-print"></i> Imprimir
          </button>
        </div>
        <div id="reportContent" style="margin-top: 30px;">
          <!-- Conteúdo do relatório será inserido aqui -->
        </div>
      </div>

      <!-- Manutenção -->
      <div id="maintenance" class="tab-content">
        <h2 class="form-title">Controle de Manutenção</h2>
        <div class="filter-container">
          <div class="filter-group">
            <label for="maintenanceStatus">Status</label>
            <select id="maintenanceStatus" class="form-control" onchange="filterMaintenance()">
              <option value="all">Todos</option>
              <option value="Pendente">Pendente</option>
              <option value="Em andamento">Em andamento</option>
              <option value="Concluído">Concluído</option>
            </select>
          </div>
          <div class="filter-group">
            <label>&nbsp;</label>
            <button class="btn btn-primary" onclick="showMaintenanceModal()">
              <i class="fas fa-tools"></i> Nova Manutenção
            </button>
          </div>
        </div>
        <div class="table-responsive">
          <table class="data-table">
            <thead>
              <tr>
                <th>Data</th>
                <th>Equipamento</th>
                <th>Nº Série</th>
                <th>Problemas</th>
                <th>Técnicos</th>
                <th>Status</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody id="maintenanceTable">
              <!-- Preenchido dinamicamente -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Aba de Registro -->
      <div id="registration" class="tab-content">
        <h2 class="form-title">
          <i class="fas fa-clipboard-check"></i> Registro de Retirada e Entrega de Equipamentos
        </h2>
        <!-- Conteúdo da aba de registro -->
      </div>
    </div>
  </div>

  <!-- Modal para Nova Reserva -->
  <div id="reservationModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Nova Reserva de Equipamento</h3>
        <button class="modal-close" onclick="closeModal('reservationModal')">&times;</button>
      </div>
      <div class="modal-body">
        <form id="reservationForm">
          <div class="agendamento-container">
            <div class="agendamento-row">
              <div class="agendamento-group">
                <label for="professor">PROFESSOR:</label>
                <select id="professor" class="form-control" onchange="atualizarEmailEAulas()">
                  <option>Selecione</option>
                </select>
              </div>
              <div class="agendamento-group">
                <label for="email-professor">EMAIL:</label>
                <input type="email" id="email-professor" class="form-control" readonly>
              </div>
            </div>
            
            <div class="agendamento-row">
              <div class="agendamento-group">
                <label for="equipamentoAgendamento">APARELHO:</label>
                <select id="equipamentoAgendamento" class="form-control" onchange="atualizarMarca()">
                  <option value="">Selecione</option>
                  <option value="TABLET">TABLET</option>
                  <option value="SMARTPHONE">SMARTPHONE</option>
                  <option value="CHROMEBOOK">CHROMEBOOK</option>
                  <option value="NOTEBOOK">NOTEBOOK</option>
                </select>
              </div>
              <div class="agendamento-group">
                <label for="marca">MARCA:</label>
                <input type="text" id="marca" class="form-control" readonly>
              </div>
            </div>
            
            <div class="agendamento-row">
              <div class="agendamento-group">
                <label for="quantidadeAgendamento">N° DE APARELHOS:</label>
                <input type="number" id="quantidadeAgendamento" class="form-control" min="1" value="1">
              </div>
              <div class="agendamento-group datepicker-container">
                <label for="dataAgendamento">DATA:</label>
                <input type="text" id="dataAgendamento" class="form-control datepicker-input" readonly placeholder="Clique para selecionar">
                <div class="datepicker-popup" id="datepickerPopup">
                  <div class="datepicker-header">
                    <button class="datepicker-nav" id="prevMonth">&lt;</button>
                    <div class="datepicker-title" id="datepickerMonthYear"></div>
                    <button class="datepicker-nav" id="nextMonth">&gt;</button>
                  </div>
                  <div class="datepicker-grid" id="datepickerWeekdays"></div>
                  <div class="datepicker-grid" id="datepickerDays"></div>
                </div>
              </div>
            </div>
            
            <div class="agendamento-row">
              <div class="agendamento-group">
                <label for="studentClass">TURMA:</label>
                <select id="studentClass" class="form-control" required onchange="atualizarSalaEAulas()">
                  <option value="">Selecione a turma</option>
                  <!-- Opções de turmas -->
                </select>
              </div>
              <div class="agendamento-group">
                <label for="sala">SALA:</label>
                <input type="text" id="sala" class="form-control" readonly>
              </div>
            </div>
            
            <div class="agendamento-row">
              <div class="agendamento-group">
                <label>AULA(S):</label>
                <div id="aula-container" class="aula-container"></div>
              </div>
            </div>
            
            <div class="conflict-message" id="conflictMessage">
              <i class="fas fa-exclamation-circle"></i> Já existe um agendamento para este local/horário!
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('reservationModal')">Cancelar</button>
        <button class="btn btn-primary" onclick="agendarEquipamento()">
          <i class="fas fa-calendar-check"></i> AGENDAR
        </button>
      </div>
    </div>
  </div>

  <!-- Modal para Detalhes da Reserva -->
  <div id="reservationDetailModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Detalhes da Reserva</h3>
        <button class="modal-close" onclick="closeModal('reservationDetailModal')">&times;</button>
      </div>
      <div class="modal-body" id="reservationDetailContent">
        <!-- Preenchido dinamicamente -->
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('reservationDetailModal')">Fechar</button>
        <button id="cancelReservationBtn" class="btn btn-danger" style="display: none;" onclick="cancelReservation()">Cancelar Reserva</button>
        <button id="completeReservationBtn" class="btn btn-success" style="display: none;" onclick="completeReservation()">Concluir</button>
      </div>
    </div>
  </div>

  <!-- Modal para Devolução -->
  <div id="devolucaoModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="fecharModal()">&times;</span>
      <h3>Finalizar Agendamento</h3>
      <p id="modalText"></p>
      <div class="form-group">
        <label for="horaEntregaModal">Hora da Entrega:</label>
        <input type="time" id="horaEntregaModal" value="" style="background-color: var(--cinza-input);">
      </div>
      <div class="modal-buttons">
        <button class="btn btn-limpar" onclick="fecharModal()">Cancelar</button>
        <button class="btn btn-entregar" onclick="finalizarAgendamento()">Confirmar</button>
      </div>
    </div>
  </div>

  <script>
    // Configuração do Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyBOoXyjLQPfgzQM06LVy-TRSPdSM_8CjcE",
      authDomain: "gerenciamentoaparelho.firebaseapp.com",
      projectId: "gerenciamentoaparelho",
      storageBucket: "gerenciamentoaparelho.appspot.com",
      messagingSenderId: "751628186418",
      appId: "1:751628186418:web:dd68af74d9e3723c179d2b",
      measurementId: "G-K02ZZQ4JBK"
    };

    // Inicializa o Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const auth = firebase.auth();

    // Variáveis globais
    let currentUser = null;
    let equipmentChart = null;
    let equipmentCounter = 1;
    let registros = [];
    let uploadedFiles = [];
    let agendamentos = {};
    let historicoExcluidos = [];
    let aulasDisponiveis = [];
    let selectedDay = null;
    let selectedDate = null;
    let currentPopupDate = new Date();
    let popupSelectedDate = null;
    let agendamentoParaDevolver = null;
    const USER_ID = "lfSOKNcVcnZFJdrT7BpZG6H6dm32";
    const agendamentosRef = firebase.firestore ? firebase.firestore().collection("agendamentos") : null;
    const historicoExcluidosRef = firebase.firestore ? firebase.firestore().collection("historico_excluidos") : null;

    // Dados de exemplo
    const professores = {
      "ADEMAR RIBEIRO DE SOUZA": "ademarribeirosouza@prof.educacao.sp.gov.br",
      "ALEX LUTH PEREIRA MARANHAO": "luth@prof.educacao.sp.gov.br",
      // ... outros professores ...
    };

    const marcas = {
      "TABLET": "POSITIVO",
      "SMARTPHONE": "POSITIVO",
      "CHROMEBOOK": "SAMSUNG",
      "NOTEBOOK": "POSITIVO"
    };

    const salasPorTurmaPeriodo = {
      "6° ANO A MANHA": "Sala 1",
      "6° ANO B MANHA": "Sala 2",
      // ... outras salas ...
    };

    const monthNames = [
      "Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho",
      "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"
    ];
    
    const weekdays = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];
    
    // Inicialização do sistema
    document.addEventListener('DOMContentLoaded', function() {
      // Configura data atual nos formulários
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('withdrawalDate')?.value = today;
      document.getElementById('returnDate')?.value = today;
      document.getElementById('registrationDate')?.value = today;
      document.getElementById('reservationDate')?.value = today;
      document.getElementById('maintenanceDate')?.value = today;
      
      // Preencher a tabela de registros
      loadRegistrationTable();
      
      // Configura evento para mostrar intervalo de datas personalizado
      document.getElementById('reportDate')?.addEventListener('change', function() {
        document.getElementById('customDateRange').style.display = this.value === 'custom' ? 'block' : 'none';
      });
      
      // Preencher dropdown de professores
      const teacherSelect = document.getElementById('professor');
      if (teacherSelect) {
        for (const [nome, email] of Object.entries(professores)) {
          const option = document.createElement('option');
          option.value = nome;
          option.textContent = nome;
          teacherSelect.appendChild(option);
        }
      }
      
      // Preencher dropdown de turmas
      const classSelect = document.getElementById('studentClass');
      if (classSelect) {
        for (const turma of Object.keys(salasPorTurmaPeriodo)) {
          const option = document.createElement('option');
          option.value = turma;
          option.textContent = turma;
          classSelect.appendChild(option);
        }
      }
      
      // Inicializar datepicker
      initDatepicker();
    });

    // Funções de autenticação
    function login() {
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      
      auth.signInWithEmailAndPassword(email, password)
        .then((userCredential) => {
          // Login bem-sucedido
          currentUser = {
            id: userCredential.user.uid,
            email: userCredential.user.email,
            nome: userCredential.user.displayName || email.split('@')[0]
          };
          
          document.getElementById('loginScreen').style.display = 'none';
          document.getElementById('mainSystem').style.display = 'block';
          document.getElementById('currentUser').textContent = currentUser.nome;
          
          // Inicializa dashboard
          updateDashboard();
          loadEquipmentTable();
          loadReservationsTable();
          loadMaintenanceTable();
          loadRegistrationTable();
        })
        .catch((error) => {
          console.error('Erro ao fazer login: ' + error.message);
          alert('Erro ao fazer login. Verifique suas credenciais.');
        });
    }

    function logout() {
      auth.signOut().then(() => {
        currentUser = null;
        document.getElementById('mainSystem').style.display = 'none';
        document.getElementById('loginScreen').style.display = 'block';
        document.getElementById('loginEmail').value = 'professor@escola.gov.br';
        document.getElementById('loginPassword').value = 'senha123';
      });
    }

    // Verifica estado de autenticação ao carregar a página
    auth.onAuthStateChanged((user) => {
      if (user) {
        currentUser = {
          id: user.uid,
          email: user.email,
          nome: user.displayName || user.email.split('@')[0]
        };
        
        document.getElementById('loginScreen').style.display = 'none';
        document.getElementById('mainSystem').style.display = 'block';
        document.getElementById('currentUser').textContent = currentUser.nome;
        
        // Inicializa dashboard
        updateDashboard();
        loadEquipmentTable();
        loadReservationsTable();
        loadMaintenanceTable();
        loadRegistrationTable();
      } else {
        // Restaura os valores padrão ao deslogar
        document.getElementById('loginEmail').value = 'professor@escola.gov.br';
        document.getElementById('loginPassword').value = 'senha123';
      }
    });

    // Funções para navegação entre abas
    function openTab(tabId) {
      // Esconde todos os conteúdos das abas
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Remove a classe active de todas as abas de navegação
      document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Mostra a aba selecionada e marca como ativa
      document.getElementById(tabId).classList.add('active');
      event.currentTarget.classList.add('active');
      
      // Atualiza o conteúdo da aba se necessário
      if (tabId === 'dashboard') {
        updateDashboard();
      } else if (tabId === 'register') {
        loadEquipmentTable();
      } else if (tabId === 'reservations') {
        loadReservationsTable();
      } else if (tabId === 'reports') {
        generateReport();
      } else if (tabId === 'maintenance') {
        loadMaintenanceTable();
      } else if (tabId === 'registration') {
        loadRegistrationTable();
      }
    }

    // ===== FUNÇÕES PARA AGENDAMENTO =====
    function atualizarMarca() {
      const tipo = document.getElementById("equipamentoAgendamento").value;
      document.getElementById("marca").value = marcas[tipo] || "";
    }

    function atualizarEmail() {
      const nome = document.getElementById("professor").value;
      document.getElementById("email-professor").value = professores[nome] || "";
    }

    function atualizarEmailEAulas() {
      atualizarEmail();
      atualizarAulasDisponiveis();
    }

    function atualizarSala() {
      const turma = document.getElementById("studentClass").value;
      document.getElementById("sala").value = salasPorTurmaPeriodo[turma] || "Sala não definida";
    }

    function atualizarSalaEAulas() {
      atualizarSala();
      atualizarAulasDisponiveis();
    }

    function atualizarAulasDisponiveis() {
      const professor = document.getElementById("professor").value;
      const turma = document.getElementById("studentClass").value;
      const data = document.getElementById("dataAgendamento").value;
      const aulaContainer = document.getElementById("aula-container");
      
      aulaContainer.innerHTML = '';
      aulasDisponiveis = [];
      
      if (!professor || professor === "Selecione" || !turma || !data) {
        return;
      }
      
      // Implementação simplificada para demonstração
      // Em um sistema real, você teria uma lógica mais complexa
      const aulas = ["1ª Aula", "2ª Aula", "3ª Aula", "4ª Aula", "5ª Aula", "6ª Aula"];
      
      aulas.forEach((aula, index) => {
        const aulaId = `aula-${index}`;
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.id = aulaId;
        checkbox.className = "aula-checkbox";
        checkbox.value = aula;
        
        const label = document.createElement("label");
        label.htmlFor = aulaId;
        label.className = "aula-label aula-professor";
        label.textContent = aula;
        
        aulaContainer.appendChild(checkbox);
        aulaContainer.appendChild(label);
        aulasDisponiveis.push(aula);
      });
    }

    function initDatepicker() {
      const datepickerInput = document.getElementById('dataAgendamento');
      const datepickerPopup = document.getElementById('datepickerPopup');
      const prevMonthBtn = document.getElementById('prevMonth');
      const nextMonthBtn = document.getElementById('nextMonth');
      const datepickerMonthYear = document.getElementById('datepickerMonthYear');
      const datepickerWeekdays = document.getElementById('datepickerWeekdays');
      const datepickerDays = document.getElementById('datepickerDays');

      if (!datepickerInput || !datepickerPopup) return;

      datepickerWeekdays.innerHTML = weekdays.map(day =>  
        `<div class="datepicker-weekday">${day}</div>` 
      ).join('');

      datepickerInput.addEventListener('click', () => {
        datepickerPopup.classList.toggle('active');
        renderDatepicker();
      });

      prevMonthBtn.addEventListener('click', () => {
        currentPopupDate.setMonth(currentPopupDate.getMonth() - 1);
        renderDatepicker();
      });

      nextMonthBtn.addEventListener('click', () => {
        currentPopupDate.setMonth(currentPopupDate.getMonth() + 1);
        renderDatepicker();
      });

      document.addEventListener('click', (e) => {
        if (!datepickerPopup.contains(e.target) && e.target !== datepickerInput) {
          datepickerPopup.classList.remove('active');
        }
      });

      function renderDatepicker() {
        const year = currentPopupDate.getFullYear();
        const month = currentPopupDate.getMonth();
        
        datepickerMonthYear.textContent = `${monthNames[month]} ${year}`;
        
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const daysInPrevMonth = new Date(year, month, 0).getDate();
        
        let daysHtml = '';
        const today = new Date();
        
        for (let i = 0; i < firstDay; i++) {
          daysHtml += `<div class="datepicker-day datepicker-other-month disabled">${daysInPrevMonth - firstDay + i + 1}</div>`;
        }
        
        for (let i = 1; i <= daysInMonth; i++) {
          const date = new Date(year, month, i);
          const isToday = date.toDateString() === today.toDateString();
          const isSelected = popupSelectedDate && date.toDateString() === popupSelectedDate.toDateString();
          const isPast = date < new Date(today.getFullYear(), today.getMonth(), today.getDate());
          
          let dayClass = 'datepicker-day';
          if (isToday) dayClass += ' today';
          if (isSelected) dayClass += ' selected';
          if (isPast) dayClass += ' disabled';
          
          daysHtml += `<div class="${dayClass}" data-day="${i}">${i}</div>`;
        }
        
        const totalCells = 42;
        const remainingCells = totalCells - (firstDay + daysInMonth);
        for (let i = 1; i <= remainingCells; i++) {
          daysHtml += `<div class="datepicker-day datepicker-other-month disabled">${i}</div>`;
        }
        
        datepickerDays.innerHTML = daysHtml;
        
        document.querySelectorAll('.datepicker-day:not(.disabled)').forEach(day => {
          day.addEventListener('click', () => {
            const dayNum = parseInt(day.getAttribute('data-day'));
            popupSelectedDate = new Date(year, month, dayNum);
            
            const formattedDay = String(dayNum).padStart(2, '0');
            const formattedMonth = String(month + 1).padStart(2, '0');
            selectedDate = `${formattedDay}/${formattedMonth}/${year}`;
            datepickerInput.value = selectedDate;
            
            datepickerPopup.classList.remove('active');
            atualizarAulasDisponiveis();
          });
        });
      }
      
      renderDatepicker();
    }

    async function agendarEquipamento() {
      const professor = document.getElementById("professor").value;
      const aparelho = document.getElementById("equipamentoAgendamento").value;
      const turma = document.getElementById("studentClass").value;
      const numAparelhos = parseInt(document.getElementById("quantidadeAgendamento").value);
      const sala = document.getElementById("sala").value;
      const data = document.getElementById("dataAgendamento").value;
      
      // Obter aulas selecionadas
      const aulasSelecionadas = [];
      document.querySelectorAll('.aula-checkbox:checked').forEach(checkbox => {
        aulasSelecionadas.push(checkbox.value);
      });
      
      if (!professor || professor === "Selecione" || !aparelho || !turma || !numAparelhos || !data || !sala || aulasSelecionadas.length === 0) {
        alert("Preencha todos os campos obrigatórios do formulário antes de agendar!");
        return;
      }
      
      const [dia, mes, ano] = data.split('/');
      const mesAno = `${ano}-${mes}`;
      
      try {
        // Simulação de salvar no Firebase
        // Em um sistema real, você usaria firebase.firestore().collection("agendamentos").add(...)
        const novoAgendamento = {
          dia: parseInt(dia),
          mesAno,
          aparelho,
          professor,
          turma,
          numAparelhos,
          aula: aulasSelecionadas.join(', '),
          sala,
          dataAgendamento: new Date().toISOString(),
          status: "Agendado"
        };
        
        // Adicionar à tabela de reservas
        addReservationToTable(novoAgendamento);
        
        alert("Agendamento realizado com sucesso!");
        closeModal('reservationModal');
      } catch (error) {
        console.error("Erro ao salvar agendamento:", error);
        alert("Erro ao salvar agendamento. Detalhes: " + error.message);
      }
    }

    function addReservationToTable(reservation) {
      const tableBody = document.getElementById('reservationsTable');
      if (!tableBody) return;
      
      const row = document.createElement('tr');
      const formattedDate = new Date(reservation.dataAgendamento).toLocaleDateString('pt-BR');
      
      row.innerHTML = `
        <td>${formattedDate}</td>
        <td>${reservation.professor}</td>
        <td>${reservation.aparelho}</td>
        <td>${reservation.numAparelhos}</td>
        <td>${reservation.sala}</td>
        <td>
          <span class="badge badge-primary">
            ${reservation.status}
          </span>
        </td>
        <td>
          <button class="btn btn-sm btn-primary" onclick="viewReservationDetail('${reservation.id}')">
            <i class="fas fa-eye"></i>
          </button>
          <button class="btn btn-sm btn-danger" onclick="cancelReservation('${reservation.id}')">
            <i class="fas fa-times"></i>
          </button>
        </td>
      `;
      
      tableBody.appendChild(row);
    }

    function viewReservationDetail(id) {
      // Implementação simplificada
      alert("Visualizando detalhes da reserva ID: " + id);
    }

    function cancelReservation(id) {
      if (confirm("Tem certeza que deseja cancelar esta reserva?")) {
        // Implementação simplificada
        alert("Reserva ID: " + id + " cancelada com sucesso!");
      }
    }

    function showNewReservationModal() {
      document.getElementById('reservationModal').style.display = 'flex';
      // Resetar o formulário
      document.getElementById('professor').value = "Selecione";
      document.getElementById('email-professor').value = "";
      document.getElementById('equipamentoAgendamento').value = "";
      document.getElementById('marca').value = "";
      document.getElementById('quantidadeAgendamento').value = "1";
      document.getElementById('studentClass').value = "";
      document.getElementById('sala').value = "";
      document.getElementById('dataAgendamento').value = "";
      document.getElementById('aula-container').innerHTML = '';
      document.getElementById('conflictMessage').style.display = 'none';
    }

    function closeModal(modalId) {
      document.getElementById(modalId).style.display = 'none';
    }

    function fecharModal() {
      document.getElementById('devolucaoModal').style.display = 'none';
      agendamentoParaDevolver = null;
    }

    function finalizarAgendamento() {
      // Implementação simplificada
      alert("Devolução registrada com sucesso!");
      fecharModal();
    }

    function loadReservationsTable() {
      // Implementação simplificada
      // Em um sistema real, você buscaria as reservas do Firebase
      const tableBody = document.getElementById('reservationsTable');
      if (!tableBody) return;
      
      // Limpar tabela
      tableBody.innerHTML = '';
      
      // Adicionar dados de exemplo
      const reservations = [
        {
          id: "res001",
          data: "2023-07-20",
          professor: "Ana Paula de Oliveira Souza",
          equipamento: "Notebook do aluno",
          quantidade: 15,
          local: "Sala de aula",
          status: "Confirmada"
        },
        {
          id: "res002",
          data: "2023-07-19",
          professor: "Rodrigo Vieira",
          equipamento: "Tablets",
          quantidade: 10,
          local: "Sala de informática",
          status: "Pendente"
        }
      ];
      
      reservations.forEach(res => {
        const row = document.createElement('tr');
        const formattedDate = new Date(res.data).toLocaleDateString('pt-BR');
        
        row.innerHTML = `
          <td>${formattedDate}</td>
          <td>${res.professor}</td>
          <td>${res.equipamento}</td>
          <td>${res.quantidade}</td>
          <td>${res.local}</td>
          <td>
            <span class="badge ${res.status === 'Confirmada' ? 'badge-success' : 'badge-warning'}">
              ${res.status}
            </span>
          </td>
          <td>
            <button class="btn btn-sm btn-primary" onclick="viewReservationDetail('${res.id}')">
              <i class="fas fa-eye"></i>
            </button>
            <button class="btn btn-sm btn-danger" onclick="cancelReservation('${res.id}')">
              <i class="fas fa-times"></i>
            </button>
          </td>
        `;
        
        tableBody.appendChild(row);
      });
    }

    // ===== FUNÇÕES DO SISTEMA PRINCIPAL =====
    function updateDashboard() {
      // Implementação simplificada
      document.getElementById('inUseCount').textContent = '12';
      document.getElementById('availableCount').textContent = '45';
      document.getElementById('maintenanceCount').textContent = '8';
      document.getElementById('damagedCount').textContent = '5';
    }

    function loadEquipmentTable() {
      // Implementação simplificada
    }

    function loadMaintenanceTable() {
      // Implementação simplificada
    }

    function loadRegistrationTable() {
      // Implementação simplificada
    }

    function generateReport() {
      // Implementação simplificada
      alert("Relatório gerado com sucesso!");
    }

    function exportReport() {
      // Implementação simplificada
      alert("Relatório exportado com sucesso!");
    }

    function printReport() {
      window.print();
    }

    function showAddEquipmentModal() {
      // Implementação simplificada
      alert("Abrindo modal para adicionar equipamento");
    }

    function showMaintenanceModal() {
      // Implementação simplificada
      alert("Abrindo modal para manutenção");
    }

    function refreshReservations() {
      loadReservationsTable();
      alert("Lista de reservas atualizada!");
    }
  </script>
</body>
</html>
