<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AGENDAMENTO DE APARELHOS</title>
  <style>
    /* Todo o CSS existente foi preservado */
    :root {
      --azul-escuro: #0a2463;
      --azul-medio: #3e92cc;
      --azul-claro: #d6eaff;
      --verde: #4caf50;
      --vermelho: #f44336;
      --cinza-escuro: #333;
      --cinza-claro: #f5f5f5;
      --branco: #ffffff;
      --branco-brilhante: rgba(255, 255, 255, 0.9);
      --verde-disponivel: #2ecc71;
      --azul-agendado: #3498db;
      --azul-selecionado: #1a5276;
      --fundo-cinza: #f0f0f0;
      --entregue: #d4edda;
      --nao-entregue: #f8d7da;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    body {
      background: linear-gradient(to bottom, var(--azul-escuro) 0%, var(--azul-escuro) 50%, #111 50%, #111 100%);
      color: var(--cinza-claro);
      min-height: 100vh;
      padding: 20px;
    }

    h2 {
      color: var(--branco);
      margin-bottom: 20px;
      text-align: center;
      text-transform: uppercase;
    }

    h3 {
      color: #000000;
      margin: 0.4cm 0;
      text-align: center;
      text-transform: uppercase;
      font-size: 0.9em;
    }

    .container {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
    }

    .form-container {
      flex: 1;
      min-width: 300px;
      background-color: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      color: var(--cinza-escuro);
    }

    .calendar-container {
      flex: 1;
      min-width: 300px;
      background-color: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      color: var(--cinza-escuro);
    }

    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 1.5rem;
    }

    .form-group {
      flex: 1;
      min-width: 220px;
      position: relative;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: var(--azul-escuro);
    }

    .form-group input,
    .form-group select {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid var(--branco-brilhante);
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background-color: var(--branco);
    }

    .form-group input[type="time"] {
      width: 120px;
      padding: 8px 10px;
    }

    .form-group input:focus,
    .form-group select:focus {
      border-color: var(--azul-medio);
      box-shadow: 0 0 0 3px rgba(62, 146, 204, 0.2);
      outline: none;
    }

    /* Estilo para dropdown com cores alternadas */
    .form-group select option:nth-child(odd) {
      background-color: var(--azul-claro);
    }
    
    .form-group select option:nth-child(even) {
      background-color: var(--branco);
    }

    .calendar {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      margin-bottom: 0.4cm;
    }

    .calendar th,
    .calendar td {
      width: 40px;
      height: 40px;
      text-align: center;
      vertical-align: middle;
      border: 1px solid var(--branco-brilhante);
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      background-color: var(--branco);
      padding: 10px;
    }

    .calendar th {
      background-color: var(--azul-claro);
      border: 1px solid var(--branco-brilhante);
    }

    .calendar td.disponivel {
      background-color: var(--verde-disponivel);
      color: white;
      cursor: default;
      border: 1px solid var(--branco-brilhante);
    }

    .calendar td.agendado {
      background-color: var(--azul-agendado);
      color: white;
      border: 1px solid var(--branco-brilhante);
      cursor: default;
    }

    .calendar td.selecionado {
      background-color: var(--azul-selecionado);
      color: white;
      font-weight: bold;
      border: 1px solid var(--branco-brilhante);
      cursor: default;
    }

    .calendar td.indisponivel {
      background-color: #ccc;
      cursor: not-allowed;
      color: #666;
      border: 1px solid var(--branco-brilhante);
    }

    .calendar td:hover:not(.indisponivel) {
      opacity: 0.8;
    }

    /* Estilos para a tabela de histórico */
    .historico-table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }

    .historico-table th,
    .historico-table td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
      word-wrap: break-word;
      overflow-wrap: break-word;
      font-size: 0.8em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .historico-table th {
      background-color: var(--azul-claro);
      color: #000;
      font-weight: bold;
    }

    .historico-table td {
      color: #000;
    }

    .historico-table tr.excluido td {
      color: var(--vermelho);
    }

    .historico-table tr.entregue {
      background-color: var(--entregue);
    }

    .historico-table tr.nao-entregue {
      background-color: var(--nao-entregue);
    }

    /* Definindo larguras específicas para cada coluna */
    .historico-table th:nth-child(1),
    .historico-table td:nth-child(1) {
      width: 12%;
    }

    .historico-table th:nth-child(2),
    .historico-table td:nth-child(2) {
      width: 18%;
    }

    .historico-table th:nth-child(3),
    .historico-table td:nth-child(3) {
      width: 8%;
    }

    .historico-table th:nth-child(4),
    .historico-table td:nth-child(4) {
      width: 12%;
    }

    .historico-table th:nth-child(5),
    .historico-table td:nth-child(5) {
      width: 20%;
    }

    .historico-table th:nth-child(6),
    .historico-table td:nth-child(6) {
      width: 15%;
    }

    .historico-table th:nth-child(7),
    .historico-table td:nth-child(7) {
      width: 8%;
    }

    .historico-table th:nth-child(8),
    .historico-table td:nth-child(8) {
      width: 7%;
    }

    /* Estilos para os botões */
    .buttons-container {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
    }

    .btn:active {
      transform: translateY(2px);
      box-shadow: 0 2px 3px rgba(0, 0, 0, 0.1);
    }

    .btn-cadastrar {
      background-color: var(--azul-medio);
      color: white;
    }

    .btn-cadastrar:hover {
      background-color: #2c7ebd;
    }

    .btn-cadastrar:active {
      box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.2);
    }

    .btn-limpar {
      background-color: #f0f0f0;
      color: #333;
    }

    .btn-limpar:hover {
      background-color: #e0e0e0;
    }

    .btn-limpar:active {
      box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.2);
    }

    .btn-excluir {
      background-color: var(--vermelho);
      color: white;
    }

    .btn-excluir:hover {
      background-color: #d32f2f;
    }

    .btn-excluir:active {
      box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.2);
    }

    /* Estilos para o calendário pop-up */
    .datepicker-container {
      position: relative;
    }

    .datepicker-popup {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      z-index: 1000;
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      width: 300px;
    }

    .datepicker-popup.active {
      display: block;
    }

    .datepicker-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .datepicker-nav {
      background: none;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
    }

    .datepicker-title {
      font-weight: bold;
    }

    .datepicker-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }

    .datepicker-weekday {
      text-align: center;
      font-weight: bold;
      padding: 5px;
    }

    .datepicker-day {
      text-align: center;
      padding: 5px;
      cursor: pointer;
      border-radius: 4px;
    }

    .datepicker-day:hover {
      background-color: var(--azul-claro);
    }

    .datepicker-day.selected {
      background-color: var(--azul-medio);
      color: white;
    }

    .datepicker-day.disabled {
      color: #ccc;
      cursor: not-allowed;
    }

    .datepicker-today {
      font-weight: bold;
    }

    .datepicker-other-month {
      color: #aaa;
    }

    .datepicker-input {
      cursor: pointer;
    }

    .conflict-message {
      color: var(--vermelho);
      font-weight: bold;
      margin-top: 10px;
      text-align: center;
      display: none;
    }
    
    .loading-indicator {
      display: none;
      text-align: center;
      margin: 10px 0;
      color: var(--azul-escuro);
      font-weight: bold;
    }

    /* Novos estilos para a seleção de aulas */
    .aulas-container {
      margin-top: 15px;
    }

    .periodo-aulas {
      margin-bottom: 15px;
      padding: 10px;
      background-color: var(--azul-claro);
      border-radius: 8px;
    }

    .periodo-title {
      font-weight: bold;
      margin-bottom: 8px;
      color: var(--azul-escuro);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .aulas-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .aula-option {
      padding: 8px 12px;
      background-color: var(--branco);
      border: 1px solid var(--azul-medio);
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 0.85em;
    }

    .aula-option:hover {
      background-color: var(--azul-claro);
    }

    .aula-option.selected {
      background-color: var(--azul-medio);
      color: white;
      border-color: var(--azul-escuro);
    }

    .selected-aulas {
      margin-top: 10px;
      padding: 10px;
      background-color: var(--fundo-cinza);
      border-radius: 8px;
    }

    .selected-aulas-title {
      font-weight: bold;
      margin-bottom: 5px;
      color: var(--azul-escuro);
    }

    .selected-aulas-list {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
    }

    .selected-aula {
      padding: 5px 10px;
      background-color: var(--azul-medio);
      color: white;
      border-radius: 15px;
      font-size: 0.8em;
      position: relative;
      cursor: pointer;
    }

    .selected-aula:hover {
      background-color: var(--azul-escuro);
    }

    /* Botão para selecionar todas as aulas */
    .select-all-btn {
      padding: 5px 10px;
      background-color: var(--azul-escuro);
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.8em;
    }

    .select-all-btn:hover {
      background-color: var(--azul-selecionado);
    }

    /* Estilos para ícones de ação */
    .action-icons {
      display: flex;
      gap: 5px;
      justify-content: center;
    }

    .action-icon {
      width: 20px;
      height: 20px;
      cursor: pointer;
      border-radius: 3px;
      padding: 2px;
      transition: all 0.2s;
    }

    .edit-icon {
      background-color: #4CAF50;
      color: white;
    }

    .edit-icon:hover {
      background-color: #45a049;
    }

    .delete-icon {
      background-color: #f44336;
      color: white;
    }

    .delete-icon:hover {
      background-color: #da190b;
    }

    /* Estilos para modal de edição */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.4);
    }

    .modal-content {
      background-color: #fefefe;
      margin: 15% auto;
      padding: 20px;
      border: none;
      border-radius: 10px;
      width: 80%;
      max-width: 500px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .close:hover,
    .close:focus {
      color: black;
    }

    .modal h3 {
      color: var(--azul-escuro);
      margin-bottom: 15px;
    }

    .modal .form-group {
      margin-bottom: 15px;
    }

    .modal .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: var(--azul-escuro);
    }

    .modal .form-group input,
    .modal .form-group select {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    .modal-buttons {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      margin-top: 20px;
    }

    .btn-modal {
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }

    .btn-save {
      background-color: var(--azul-medio);
      color: white;
    }

    .btn-cancel {
      background-color: #ccc;
      color: #333;
    }
  </style>
</head>
<body>
  <h2>AGENDAMENTO DE APARELHOS</h2>
  <div class="container">
    <div class="form-container">
      <div class="form-row">
        <div class="form-group">
          <label>PROFESSOR:</label>
          <select id="professor" onchange="atualizarEmail(); carregarAulasProfessor();">
            <option>Selecione</option>
          </select>
        </div>
        <div class="form-group">
          <label>EMAIL:</label>
          <input type="email" id="email-professor" readonly>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>APARELHO:</label>
          <select id="aparelho" onchange="atualizarMarca()">
            <option value="">Selecione</option>
            <option value="TABLET">TABLET</option>
            <option value="SMARTPHONE">SMARTPHONE</option>
            <option value="CHROMEBOOK">CHROMEBOOK</option>
            <option value="NOTEBOOK">NOTEBOOK</option>
          </select>
        </div>

        <div class="form-group">
          <label>MARCA:</label>
          <input type="text" id="marca" readonly>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>N° DE APARELHOS:</label>
          <input type="number" id="numero-aparelhos" min="1" value="1">
        </div>
        
        <div class="form-group datepicker-container">
          <label>DATA:</label>
          <input type="text" id="data-selecionada" class="datepicker-input" readonly placeholder="Clique para selecionar">
          <div class="datepicker-popup" id="datepickerPopup">
            <div class="datepicker-header">
              <button class="datepicker-nav" id="prevMonth">&lt;</button>
              <div class="datepicker-title" id="datepickerMonthYear"></div>
              <button class="datepicker-nav" id="nextMonth">&gt;</button>
            </div>
            <div class="datepicker-grid" id="datepickerWeekdays"></div>
            <div class="datepicker-grid" id="datepickerDays"></div>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>SELECIONE A TURMA:</label>
          <select id="studentClass" class="form-control" required onchange="atualizarSala()">
            <option value="">Selecione a turma</option>
            <option value="6° ANO A MANHA">6° ANO A MANHA</option>
            <option value="6° ANO B MANHA">6° ANO B MANHA</option>
            <option value="6° ANO C MANHA">6° ANO C MANHA</option>
            <option value="6° ANO D MANHA">6° ANO D MANHA</option>
            <option value="6° ANO E TARDE">6° ANO E TARDE</option>
            <option value="6° ANO F TARDE">6° ANO F TARDE</option>
            <option value="7° ANO A TARDE">7° ANO A TARDE</option>
            <option value="7° ANO B TARDE">7° ANO B TARDE</option>
            <option value="7° ANO C TARDE">7° ANO C TARDE</option>
            <option value="7° ANO D TARDE">7° ANO D TARDE</option>
            <option value="7° ANO E TARDE">7° ANO E TARDE</option>
            <option value="7° ANO F TARDE">7° ANO F TARDE</option>
            <option value="8° ANO A TARDE">8° ANO A TARDE</option>
            <option value="8° ANO B TARDE">8° ANO B TARDE</option>
            <option value="8° ANO C TARDE">8° ANO C TARDE</option>
            <option value="8° ANO D TARDE">8° ANO D TARDE</option>
            <option value="8° ANO E TARDE">8° ANO E TARDE</option>
            <option value="9° ANO A TARDE">9° ANO A TARDE</option>
            <option value="9° ANO B TARDE">9° ANO B TARDE</option>
            <option value="9° ANO C TARDE">9° ANO C TARDE</option>
            <option value="9° ANO D TARDE">9° ANO D TARDE</option>
            <option value="1ª SERIE A MANHA">1ª SERIE A MANHA</option>
            <option value="1ª SERIE B MANHA">1ª SERIE B MANHA</option>
            <option value="1ª SERIE C MANHA">1ª SERIE C MANHA</option>
            <option value="1ª SERIE D MANHA">1ª SERIE D MANHA</option>
            <option value="1ª SERIE E MANHA">1ª SERIE E MANHA</option>
            <option value="1ª SERIE F MANHA">1ª SERIE F MANHA</option>
            <option value="1ª SERIE G TARDE">1ª SERIE G TARDE</option>
            <option value="1ª SERIE H NOITE">1ª SERIE H NOITE</option>
            <option value="1ª SERIE I NOITE">1ª SERIE I NOITE</option>
            <option value="2ª SERIE A MANHA">2ª SERIE A MANHA</option>
            <option value="2ª SERIE B MANHA">2ª SERIE B MANHA</option>
            <option value="2ª SERIE C MANHA">2ª SERIE C MANHA</option>
            <option value="2ª SERIE D MANha">2ª SERIE D MANha</option>
            <option value="2ª SERIE E MANHA">2ª SERIE E MANHA</option>
            <option value="2ª SERIE F NOITE">2ª SERIE F NOITE</option>
            <option value="2ª SERIE G NOITE">2ª SERIE G NOITE</option>
            <option value="2ª SERIE H NOITE">2ª SERIE H NOITE</option>
            <option value="2ª SERIE I NOITE">2ª SERie I NOITE</option>
            <option value="3ª SERIE A MANHA">3ª SERIE A MANHA</option>
            <option value="3ª SERIE B MANHA">3ª SERIE B MANHA</option>
            <option value="3ª SERIE C MANHA">3ª SERIE C MANHA</option>
            <option value="3ª SERIE D NOITE">3ª SERIE D NOITE</option>
            <option value="3ª SERIE E NOITE">3ª SERIE E NOITE</option>
            <option value="3ª SERIE F NOITE">3ª SERIE F NOITE</option>
            <option value="3ª SERIE G NOITE">3ª SERIE G NOITE</option>
            <option value="4050 - ADMINISTRAÇÃO - 2ª SERIE A MANHA">4050 - ADMINISTRAÇÃO - 2ª SERIE A MANHA</option>
          </select>
        </div>

        <div class="form-group">
          <label>SALA:</label>
          <input type="text" id="sala" readonly>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group" onclick="abrirRelogio('hora-retirada')" style="cursor: pointer;">
          <label for="hora-retirada">RETIRADA:</label>
          <input type="time" id="hora-retirada" required>
        </div>
        <div class="form-group" onclick="abrirRelogio('hora-entrega')" style="cursor: pointer;">
          <label for="hora-entrega">ENTREGA:</label>
          <input type="time" id="hora-entrega">
        </div>
      </div>

      <!-- Área de seleção de aulas modificada -->
      <div class="form-group">
        <label>AULAS DISPONÍVEIS:</label>
        <div class="loading-indicator" id="aulaLoading">Carregando horários...</div>
        <div id="aulasProfessorContainer" class="aulas-container">
          <!-- As aulas serão carregadas dinamicamente aqui -->
        </div>
        <div id="selectedAulasContainer" class="selected-aulas" style="display: none;">
          <div class="selected-aulas-title">Aulas selecionadas:</div>
          <div id="selectedAulasList" class="selected-aulas-list"></div>
        </div>
      </div>

      <div class="conflict-message" id="conflictMessage">
        Já existe um agendamento para esta turma nesta data e aula!
      </div>

      <div class="buttons-container">
        <button class="btn btn-cadastrar" onclick="cadastrarAgendamento()">CADASTRAR</button>
        <button class="btn btn-limpar" onclick="limparFormulario()">LIMPAR</button>
      </div>
    </div>

    <div class="calendar-container">
      <div style="margin-bottom: 20px;">
        <select id="monthSelect"></select>
        <select id="yearSelect"></select>
      </div>

      <table class="calendar">
        <thead>
          <tr>
            <th>Dom</th>
            <th>Seg</th>
            <th>Ter</th>
            <th>Qua</th>
            <th>Qui</th>
            <th>Sex</th>
            <th>Sáb</th>
          </tr>
        </thead>
        <tbody id="calendarBody">
          <!-- Dias serão inseridos via JavaScript -->
        </tbody>
      </table>

      <h3>HISTÓRICO DE AGENDAMENTOS</h3>
      <table class="historico-table">
        <thead>
          <tr>
            <th>DATA</th>
            <th>TURMA</th>
            <th>N° APARELHOS</th>
            <th>APARELHO</th>
            <th>PROFESSOR</th>
            <th>AULA(s)</th>
            <th>ENTREGA</th>
            <th>AÇÃO</th>
          </tr>
        </thead>
        <tbody id="historico-body">
          <!-- Histórico dinâmico -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- Modal de edição -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h3>Editar Agendamento</h3>
      <div class="form-group">
        <label>Data:</label>
        <input type="date" id="editData">
      </div>
      <div class="form-group">
        <label>Turma:</label>
        <select id="editTurma">
          <option value="6° ANO A MANHA">6° ANO A MANHA</option>
          <option value="6° ANO B MANHA">6° ANO B MANHA</option>
          <option value="6° ANO C MANHA">6° ANO C MANHA</option>
          <option value="6° ANO D MANHA">6° ANO D MANHA</option>
          <option value="6° ANO E TARDE">6° ANO E TARDE</option>
          <option value="6° ANO F TARDE">6° ANO F TARDE</option>
          <option value="7° ANO A TARDE">7° ANO A TARDE</option>
          <option value="7° ANO B TARDE">7° ANO B TARDE</option>
          <option value="7° ANO C TARDE">7° ANO C TARDE</option>
          <option value="7° ANO D TARDE">7° ANO D TARDE</option>
          <option value="7° ANO E TARDE">7° ANO E TARDE</option>
          <option value="7° ANO F TARDE">7° ANO F TARDE</option>
          <option value="8° ANO A TARDE">8° ANO A TARDE</option>
          <option value="8° ANO B TARDE">8° ANO B TARDE</option>
          <option value="8° ANO C TARDE">8° ANO C TARDE</option>
          <option value="8° ANO D TARDE">8° ANO D TARDE</option>
          <option value="8° ANO E TARDE">8° ANO E TARDE</option>
          <option value="9° ANO A TARDE">9° ANO A TARDE</option>
          <option value="9° ANO B TARDE">9° ANO B TARDE</option>
          <option value="9° ANO C TARDE">9° ANO C TARDE</option>
          <option value="9° ANO D TARDE">9° ANO D TARDE</option>
          <option value="1ª SERIE A MANHA">1ª SERIE A MANHA</option>
          <option value="1ª SERIE B MANHA">1ª SERIE B MANHA</option>
          <option value="1ª SERIE C MANHA">1ª SERIE C MANHA</option>
          <option value="1ª SERIE D MANHA">1ª SERIE D MANHA</option>
          <option value="1ª SERIE E MANHA">1ª SERIE E MANHA</option>
          <option value="1ª SERIE F MANHA">1ª SERIE F MANHA</option>
          <option value="1ª SERIE G TARDE">1ª SERIE G TARDE</option>
          <option value="1ª SERIE H NOITE">1ª SERIE H NOITE</option>
          <option value="1ª SERIE I NOITE">1ª SERIE I NOITE</option>
          <option value="2ª SERIE A MANHA">2ª SERIE A MANHA</option>
          <option value="2ª SERIE B MANHA">2ª SERIE B MANHA</option>
          <option value="2ª SERIE C MANHA">2ª SERIE C MANHA</option>
          <option value="2ª SERIE D MANha">2ª SERIE D MANha</option>
          <option value="2ª SERIE E MANHA">2ª SERIE E MANHA</option>
          <option value="2ª SERIE F NOITE">2ª SERIE F NOITE</option>
          <option value="2ª SERIE G NOITE">2ª SERIE G NOITE</option>
          <option value="2ª SERIE H NOITE">2ª SERIE H NOITE</option>
          <option value="2ª SERIE I NOITE">2ª SERie I NOITE</option>
          <option value="3ª SERIE A MANHA">3ª SERIE A MANHA</option>
          <option value="3ª SERIE B MANHA">3ª SERIE B MANHA</option>
          <option value="3ª SERIE C MANHA">3ª SERIE C MANHA</option>
          <option value="3ª SERIE D NOITE">3ª SERIE D NOITE</option>
          <option value="3ª SERIE E NOITE">3ª SERIE E NOITE</option>
          <option value="3ª SERIE F NOITE">3ª SERIE F NOITE</option>
          <option value="3ª SERIE G NOITE">3ª SERIE G NOITE</option>
          <option value="4050 - ADMINISTRAÇÃO - 2ª SERIE A MANHA">4050 - ADMINISTRAÇÃO - 2ª SERIE A MANHA</option>
        </select>
      </div>
      <div class="form-group">
        <label>N° de Aparelhos:</label>
        <input type="number" id="editNumAparelhos" min="1">
      </div>
      <div class="form-group">
        <label>Aparelho:</label>
        <select id="editAparelho">
          <option value="TABLET">TABLET</option>
          <option value="SMARTPHONE">SMARTPHONE</option>
          <option value="CHROMEBOOK">CHROMEBOOK</option>
          <option value="NOTEBOOK">NOTEBOOK</option>
        </select>
      </div>
      <div class="form-group">
        <label>Professor:</label>
        <input type="text" id="editProfessor">
      </div>
      <div class="form-group">
        <label>Aulas:</label>
        <input type="text" id="editAulas">
      </div>
      <div class="modal-buttons">
        <button class="btn-modal btn-save" onclick="salvarEdicao()">Salvar</button>
        <button class="btn-modal btn-cancel" onclick="fecharModal()">Cancelar</button>
      </div>
    </div>
  </div>

  <script>
    // Dados dos professores
    const teacherEmails = {
      "ADEMAR RIBEIRO DE SOUZA": "ademarribeirosouza@prof.educacao.sp.gov.br",
      "ALEX LUTH PEREIRA MARANHAO": "luth@prof.educacao.sp.gov.br",
      "ALEXANDRE SILVA LIMA": "alexandresilvalima@prof.educacao.sp.gov.br",
      "ALEXSANDRA PAULA VARELLA DE SOUZA": "avarella@prof.educacao.sp.gov.br",
      "ALINE CARDOSO": "aline.cardoso@servidor.educacao.sp.gov.br",
      "ALISON VASCONCELOS BESERRA": "alisonv@prof.educacao.sp.gov.br",
      "AMAURI TEODORO DE OLIVEIRA": "amaurit@prof.educacao.sp.gov.br",
      "ANA PAULA DE OLIVEIRA SOUZA": "ana.souza59@servidor.educacao.sp.gov.br",
      "ANA PAULA DOS SANTOS": "paulasantosa@prof.educacao.sp.gov.br",
      "ANDRE LUIZ TAVARES": "andreltavares@prof.educacao.sp.gov.br",
      "ANDREIA DOS SANTOS FREITAS": "sanfreitas@prof.educacao.sp.gov.br",
      "ANDREIA MADUREIRA REIS": "andreiamadureira@prof.educacao.sp.gov.br",
      "ANTONIO CARLS DE OLIVEIRA": "antoniocarloso@prof.educacao.sp.gov.br",
      "ANTONIO RAMOS DE ARAUJO": "antonioramosaraujo@prof.educacao.sp.gov.br",
      "ANTONIO WILTON WANDERLEY CABRAL": "antoniowilton@prof.educacao.sp.gov.br",
      "AUGUSTO LINO PESSOA NETO": "augustolino@prof.educacao.sp.gov.br",
      "AUREA MARIA DE JESUS MARQUES": "aureamaria@prof.educacao.sp.gov.br",
      "CAROLINA PERNOMIAN PARUSSOLO": "carolinapernomian@prof.educacao.sp.gov.br",
      "CASSIA OLIVEIRA ANTONIAZI": "cassiaosilva@prof.educacao.sp.gov.br",
      "CICERO FERREIRA": "cicero.ferreira@servidor.educacao.sp.gov.br",
      "DANIEL DE FREITAS ALMEIDA": "danielalmeida@prof.educacao.sp.gov.br",
      "DANIEL LOPES BARBOSA": "daniellopesbarbosa@prof.educacao.sp.gov.br",
      "DANIELA FERREIRA LIMA": "danielaflima@prof.educacao.sp.gov.br",
      "EDIANE VIEIRA DA SILVA": "ediane@prof.educacao.sp.gov.br",
      "EDILEUSA NUNES PEREIRA": "edileusa@prof.educacao.sp.gov.br",
      "EDUARDO HENRIQUE DA FONSECA": "henriquefonseca@prof.educacao.sp.gov.br",
      "ELIANE SANTOS SILVA": "essantos@prof.educacao.sp.gov.br",
      "ELIAS MONTEIRO DA SILVA": "elias1@prof.educacao.sp.gov.br",
      "ELISABETE APARECIDA PIRES": "elisabetepires@prof.educacao.sp.gov.br",
      "ELZA DE FARIA PEREIRA": "elzafariapereira@prof.educacao.sp.gov.br",
      "EMERSON GABLER DE ALMEIDA": "egabler@prof.educacao.sp.gov.br",
      "ERINEIDE LEITE ARAGAO NERY": "erineidearagao@prof.educacao.sp.gov.br",
      "EUZELI ARAUJO DE OLIVEIRA": "euzeli@prof.educacao.sp.gov.br",
      "FABIANO AUGUSTO PIEDADE": "fabianoaugusto@prof.educacao.sp.gov.br",
      "FABIO CAMILO": "camilof@prof.educacao.sp.gov.br",
      "FERNANDO JOSE DA SILVA FILHO": "fernandojs@prof.educacao.sp.gov.br",
      "FLAVIA CRISTINA APARECIDA BICHLER": "flaviacri@prof.educacao.sp.gov.br",
      "FLAVIO CARDOSO FLEURY": "flaviofleury@prof.educacao.sp.gov.br",
      "GABRIELA SERIGHELLI DE MELO": "gabrielaserighelli@prof.educacao.sp.gov.br",
      "GENILTON DE OLIVEIRA SILVA": "genilton@prof.educacao.sp.gov.br",
      "GIANI CRISTINA DO PRADO": "gianiprado@prof.educacao.sp.gov.br",
      "INGRYD CAROLINA SUGUIMOTO VIEIRA": "ingryd@prof.educacao.sp.gov.br",
      "IVANILDES DOS SANTOS OSHIKAWA": "oshikawa@prof.educacao.sp.gov.br",
      "JANINA DOS PASSOS BRAGA DE ALMEIDA": "janinabraga@prof.educacao.sp.gov.br",
      "JUAREZ GOMES DE MAGALHAES FILHO": "juarezgomes@prof.educacao.sp.gov.br",
      "JUREMA SOLEDADE FURINI SANTOS": "juremas@prof.educacao.sp.gov.br",
      "KATIUSCIA ALVES BOMFIM": "katiusciabomfim@prof.educacao.sp.gov.br",
      "KETHY REGINA DA SILVA DOMINGOS COSTA": "kethy@prof.educacao.sp.gov.br",
      "LUANA CAROLINE ALVES LIMA": "luanalima01@prof.educacao.sp.gov.br",
      "LUANA DE FREITAS SILVA": "luanafreitas@prof.educacao.sp.gov.br",
      "LUCIANA NOVAIS CORREIA SANTOS": "novaiscorreia@prof.educacao.sp.gov.br",
      "LUCIANO MOREIRA DE AZEVEDO": "lucianomoreira@prof.educacao.sp.gov.br",
      "MARCELO FERNANDES DA SILVA": "marcelofs@prof.educacao.sp.gov.br",
      "MARCIEL DA SILVA": "marcielsilva@prof.educacao.sp.gov.br",
      "MARIA HELENA CUNHA MORO": "marcunha@prof.educacao.sp.gov.br",
      "MARIA QUITÉRIA FERREIRA DOS SANTOS": "quiteriasantos@prof.educacao.sp.gov.br",
      "MARINA DA CONCEICAO FRANCISCO SILVA": "marinafrancisco@prof.educacao.sp.gov.br",
      "MAURICIO DE BARROS SANTOS": "mauriciobsantos@prof.educacao.sp.gov.br",
      "MICHELE DE PINHO MORAES": "michelepinho@prof.educacao.sp.gov.br",
      "MOISES ANTONIO DE BARROS": "moisesbarros@prof.educacao.sp.gov.br",
      "PATRICIA GOMES ROCHA RIBEIRO": "patriciag@prof.educacao.sp.gov.br",
      "PAULO ROBERTO DA SILVA ITO": "pauloito@prof.educacao.sp.gov.br",
      "PEDRO ZANOTTI FILHO": "pedrozanotti@prof.educacao.sp.gov.br",
      "RAUL PEREIRA VILERA JUNIOR": "vilera@prof.educacao.sp.gov.br",
      "REGIANE CURTI DE SOUZA OLIVEIRA": "regianecurti@prof.educacao.sp.gov.br",
      "REGINA DA SILVA CASTRO": "reginasilvacastro@prof.educacao.sp.gov.br",
      "RICARDO AMERICO DA SILVA": "ricardoamerico@prof.educacao.sp.gov.br",
      "ROBERTO SALGADO": "robertosalgado@prof.educacao.sp.gov.br",
      "RODRIGO VIEIRA": "rodrigovieira1@prof.educacao.sp.gov.br",
      "ROSANGELA CAFASSO MOREIRA": "cafasso@prof.educacao.sp.gov.br",
      "ROSIMERY DE SOUZA PESSOA": "rosimerypessoa@prof.educacao.sp.gov.br",
      "ROSMARA DA SILVA CARDOSO": "rosmaracardoso@prof.educacao.sp.gov.br",
      "SANDRA CRISTINA MACEDO MORAES": "sandracristinamacedo@prof.educacao.sp.gov.br",
      "SELMA GOMES DA SILVA": "selmagomess@prof.educacao.sp.gov.br",
      "SERGIO AGRIPINO VILLA NOVA": "sergioagripino@prof.educacao.sp.gov.br",
      "SOLANGE ALMEIDA DA SILVA": "almeidafazio@prof.educacao.sp.gov.br",
      "SUELI SILVE PEREIRA": "suelisilve@prof.educacao.sp.gov.br",
      "SUZINEIDE SILVA DE FREITAS": "suzineidefreitas@prof.educacao.sp.gov.br",
      "THIAGO FABIANO BRITO": "thiagofabiano@prof.educacao.sp.gov.br",
      "TITTO AUGUSTO NASCIMENTO SILVA": "titto@prof.educacao.sp.gov.br",
      "VANDERSON HYPPOLITO": "vhypolito@prof.educacao.sp.gov.br",
      "VANESSA IVETE GOMES DOS SANTOS": "vanessaivete@prof.educacao.sp.gov.br",
      "VANIA PENHA DE BARROS": "vaniapenha@prof.educacao.sp.gov.br",
      "VIVIANE LEAL CAMERA DE MORAES": "camera@prof.educacao.sp.gov.br",
      "WILSON LUIZ DE SOUZA COSTA": "wilsonluizsouza@prof.educacao.sp.gov.br",
      "WILSON RODRIGUES MOTA": "wmota@prof.educacao.sp.gov.br"
    };

    // Dados dos aparelhos
    const marcas = {
      "TABLET": "POSITIVO",
      "SMARTPHONE": "POSITIVO",
      "CHROMEBOOK": "SAMSUNG",
      "NOTEBOOK": "POSITIVO"
    };

    // Dados das salas por turma e período
    const salasPorTurmaPeriodo = {
      // 6° ANO
      "6° ANO A MANHA": "Sala 1",
      "6° ANO B MANHA": "Sala 2",
      "6° ANO C MANHA": "Sala 3",
      "6° ANO D MANHA": "Sala 4",
      "6° ANO E TARDE": "Sala 1",
      "6° ANO F TARDE": "Sala 2",
      
      // 7° ANO
      "7° ANO A TARDE": "Sala 3",
      "7° ANO B TARDE": "Sala 4",
      "7° ANO C TARDE": "Sala 5",
      "7° ANO D TARDE": "Sala 6",
      "7° ANO E TARDE": "Sala 7",
      "7° ANO F TARDE": "Sala 8",
      
      // 8° ANO
      "8° ANO A TARDE": "Sala 10",
      "8° ANO B TARDE": "Sala 11",
      "8° ANO C TARDE": "Sala 12",
      "8° ANO D TARDE": "Sala 13",
      "8° ANO E TARDE": "Sala 14",
      
      // 9° ANO
      "9° ANO A TARDE": "Sala 15",
      "9° ANO B TARDE": "Sala 16",
      "9° ANO C TARDE": "Sala 17",
      "9° ANO D TARDE": "Sala 18",
      
      // 1ª SÉRIE
      "1ª SERIE A MANHA": "Sala 10",
      "1ª SERIE B MANHA": "Sala 11",
      "1ª SERIE C MANHA": "Sala 12",
      "1ª SERIE D MANHA": "Sala 13",
      "1ª SERIE E MANHA": "Sala 14",
      "1ª SERIE F MANHA": "Sala 15",
      "1ª SERIE G TARDE": "Sala 9",
      "1ª SERIE H NOITE": "Sala 9",
      "1ª SERIE I NOITE": "Sala 602",
      
      // 2ª SÉRIE
      "2ª SERIE A MANHA": "Sala 5",
      "2ª SERIE B MANHA": "Sala 6",
      "2ª SERIE C MANHA": "Sala 7",
      "2ª SERIE D MANHA": "Sala 8",
      "2ª SERIE E MANHA": "Sala 9",
      "2ª SERIE F NOITE": "Sala 1",
      "2ª SERIE G NOITE": "Sala 2",
      "2ª SERIE H NOITE": "Sala 3",
      "2ª SERIE I NOITE": "Sala 4",
      
      // 3ª SÉRIE
      "3ª SERIE A MANHA": "Sala 16",
      "3ª SERIE B MANHA": "Sala 17",
      "3ª SERIE C MANHA": "Sala 18",
      "3ª SERIE D NOITE": "Sala 5",
      "3ª SERIE E NOITE": "Sala 6",
      "3ª SERIE F NOITE": "Sala 7",
      "3ª SERIE G NOITE": "Sala 8",
      
      // ADMINISTRAÇÃO
      "4050 - ADMINISTRAÇÃO - 2ª SERIE A MANHA": "Laboratório 1"
    };

    // Horários dos professores (organizados por dias da semana)
    const horariosProfessores = {
      "ADEMAR RIBEIRO DE SOUZA": {
        "SEG": ["1D", "1E", "1E", "9A", "9A", "9C", "9C", "9D", "9A"],
        "TER": ["1F", "1F", "1B", "9D", "2F", "2H", "1H", "1H"],
        "QUA": ["1B", "1A", "1A"],
        "QUI": ["1D", "1C", "1C", "9B", "9D"],
        "SEX": ["9C", "9B", "9B", "1G", "1G", "2F", "2G", "2G", "2H"],
      },
      "ALISON VASCONCELOS BESERRA": {
        "SEG": ["6A", "6D", "6B", "1F", "6A", "6A"],
        "TER": ["1D", "6C", "1B"],
        "QUA": ["1B/BIO", "3C/PV", "6C/CIÊ", "1E/BIO", "8A", "8A", "7E/PV", "7C/PV"],
        "QUI": ["6B", "6B", "1C", "6C", "1F", "6D", "8A", "8A", "7D/PV"],
        "SEX": ["1E", "1A", "1A", "1C", "6D/C", "1D"],
      },
      "ANDRE LUIZ TAVARES": {
        "SEG": ["X", "X", "X", "X", "X"],
        "TER": ["X", "X", "X", "X", "X"],
        "QUA": ["X", "X", "X", "X", "X"],
        "QUI": ["X", "X", "X", "X", "X"],
        "SEX": ["X", "X", "X", "X", "X"],
      },
      "ANDREIA MADUREIRA REIS": {
        "SEG": ["1E", "1F", "1D", "2C", "1C", "2D"],
        "TER": ["1F/R", "1D", "1F", "1E", "1C", "1F/R"],
        "QUA": ["2C/R", "1D", "1C", "1C", "1E", "1C/R"],
        "QUI": ["1D/R", "1E", "1B/R", "1E/R", "1D/R", "1F"],
        "SEX": ["2D/R", "1E", "1C", "1F", "1D", "1B/R"],
      },
      "ANTONIO RAMOS DE ARAUJO": {
        "QUI": ["3G", "2F", "2F", "2G", "2G"],
        "SEX": ["3G", "2H", "2H", "1I", "1I"],
      },
      "ANTONIO CARLS DE OLIVEIRA": {
        "SEG": ["2B", "2B", "2E", "2E"],
        "TER": ["2C", "2C", "2D", "2D", "2A"],
        "QUA": ["2D", "2D", "2E", "2E"],
        "QUI": ["2A", "2A"],
        "SEX": ["2C", "2C", "2A", "2B", "2B"],
      },
      "ELISABETE APARECIDA PIRES": {
        "SEG": ["1A", "1A", "1A", "1E", "1B", "1B"],
        "TER": ["1E/EF", "1E/EF", "1D", "1D", "1B", "1A"],
        "QUA": ["1C/EF", "1C/EF", "1E", "1E", "1D/EF", "1D/EF"],
        "QUI": ["1C", "1C", "1E", "1B", "1A/EF", "1A/EF"],
        "SEX": ["1B/EF", "1B/EF", "1D", "1D", "1C", "1C", "1G", "1G"],
      },
      "CAROLINA PERNOMIAN PARUSSOLO": {
        "SEG": ["1G", "1G", "7A", "7A"],
        "TER": ["9D", "9D", "9A", "7B", "7B"],
        "QUA": ["9C", "9C", "7B", "7A"],
        "QUI": ["9A", "9B", "9B", "9C", "9D"],
        "SEX": ["9B", "9C", "9D", "9B", "9A", "9A"],
      },
      "CASSIA OLIVEIRA ANTONIAZI": {
        "SEG": ["8C", "8E", "8E", "8B", "8B", "8B"],
        "TER": ["8D", "8D", "8B", "8C"],
        "QUA": ["8D", "8D", "8E", "8E", "8C", "8C"],
      },
      "DANIEL DE FREITAS ALMEIDA": {
        "SEG": ["6C", "6C", "2C", "6D", "3C", "3C", "6E", "6E"],
        "TER": ["2ADM/H", "2ADM/H", "6A", "2C", "2D/L", "2D/L"],
        "QUI": ["2D", "2D", "6D", "6A", "3B", "3B"],
        "SEX": ["3A", "3A", "2C/L", "2C/L", "2E", "2E"],
      },
      "DANIEL LOPES BARBOSA": {
        "SEG": ["9B", "9B", "9D", "1G", "1G"],
        "TER": ["9A", "9B", "8E/EF", "8E/EF", "9C"],
        "QUA": ["9A", "9D", "9D", "9B", "9B"],
        "QUI": ["9C", "9A", "1G", "1G", "9C", "1H", "1H"],
        "SEX": ["9A", "9A", "9C", "9C", "9D", "9D"],
      },
      "DANIELA FERREIRA LIMA": {
        "SEG": ["1C", "1C", "6A", "6A", "6D", "6D", "", "7D", "7C", "9A", "7E", "7E", "7C"],
        "TER": ["6B", "6B", "6C", "6C", "1D", "1D", "7D", "7B", "7B", "7A", "1G", "1G", "1H"],
        "QUA": ["1A", "1A", "9D", "7A"],
        "SEX": ["1F", "1F", "1B", "1B", "1E", "1E"],
      },
      "EDIANE VIEIRA DA SILVA": {
        "SEG": ["7C", "7B", "6F/R", "6F/R", "9C/O", "9D/O", "3F", "3F", "2G", "2G", "2H"],
        "TER": ["7B", "7D", "7C", "9B/OP", "6E/R", "9B/OP", "2G", "2F", "2F", "3E/OP", "3E/OP"],
        "QUA": ["9C/OP", "7B", "2H", "2H", "2H", "2F", "2F"],
        "QUI": ["2ADM", "2ADM", "2ADM", "6F", "7D", "9D/OP", "7D", "7C", "7D"],
        "SEX": ["6E/R", "7C", "6F", "6F", "7B", "6F", "2G", "3G/OP", "3G/OP", "3D/OP", "3D/OP"],
      },
      "EDUARDO HENRIQUE DA FONSECA": {
        "QUA": ["7C", "8B", "7D", "8B", "7D", "7C"],
      },
      "ELIANE SANTOS SILVA": {
        "SEG": ["1G", "1G"],
        "TER": ["6A", "6A", "2A", "2A", "2E", "2E"],
        "QUA": ["6A", "3B/PV", "6B/PV", "6A/PV", "6B", "6D"],
        "QUI": ["6C", "6C", "6C", "6B", "6B", "3A/PV"],
        "SEX": ["6D", "2B", "2B", "6D/PV", "2C", "2C"],
      },
      "ELIAS MONTEIRO DA SILVA": {
        "SEG": ["2E", "2E", "3B", "3B", "2C", "2C", "9B", "1H/Q", "1H/Q", "1H/EF", "1H/EF"],
        "TER": ["1C", "1C", "2ADM/Q", "2ADM/Q", "3A", "3A"],
        "QUA": ["2B", "2B", "1A", "1A", "2A", "1F", "9B/OM"],
        "QUI": ["1B", "1B", "3C", "3C", "1E", "1E", "9A", "8E/PV", "9A", "8D/PV"],
        "SEX": ["1D", "1D", "1F", "2A", "2D", "2D", "1G", "1G", "9C", "9C", "1H/F", "1H/F"],
      },
      "EUZELI ARAUJO DE OLIVEIRA": {
        "SEG": ["3B", "1E", "1E", "2D", "2B"],
        "QUA": ["1B", "1B", "1D", "1D", "1F"],
        "QUI": ["1A", "1A", "2ADM", "2C", "2A"],
        "SEX": ["1C", "1C", "2E", "3A", "1F"],
      },
      "FABIO CAMILO": {
        "SEG": ["1I", "2F", "1I", "3D", "1I"],
        "TER": ["3D", "3E", "2H", "2H", "2F"],
        "QUA": ["2G", "3E", "2F", "2G", "3E"],
        "QUI": ["2H", "3D", "2G", "1I", "2H"],
        "SEX": ["3E", "3D", "2F", "2G"],
      },
      "GENILTON DE OLIVEIRA SILVA": {
        "TER": ["7E", "7E"],
        "QUA": ["7D", "6F", "7B/PV", "6E", "7F", "7D"],
        "QUI": ["7C", "7C", "6F", "6F", "6E", "6E"],
        "SEX": ["7C", "7E", "7A/PV", "7D", "7F", "7F"],
      },
      "INGRYD CAROLINA SUGUIMOTO VIEIRA": {
        "SEG": ["8E", "8D", "8D", "8E", "6E", "6E"],
        "TER": ["8C", "6F", "8D", "8D"],
        "QUA": ["6F", "6E", "6E", "6F", "6F", "8E"],
        "QUI": ["8C", "8C", "6E"],
        "SEX": ["8E", "8C", "8C", "8E", "6F", "8D"],
      },
      "JANINA DOS PASSOS BRAGA DE ALMEIDA": {
        "SEG": ["2ADM/B", "2ADM/B", "2B"],
        "TER": ["2A", "2A", "2B"],
        "QUA": ["3C/BIOT", "3C/BIOT", "2C", "2C"],
        "QUI": ["3A", "3A", "3B", "3B", "3D", "3F", "3D"],
        "SEX": ["2E", "2D", "2D", "2E", "3E", "3E", "3F"],
      },
      "JUAREZ GOMES DE MAGALHAES FILHO": {
        "SEG": ["2H", "2H", "3F", "3E", "3E"],
        "TER": ["3A", "3A", "3C", "3C", "2H/Q", "3D", "3D", "2G", "2G"],
        "QUA": ["1E", "1E", "1F", "2F/FÍS", "2G", "2G", "1I", "1I"],
        "QUI": ["1F", "1D", "1D"],
        "SEX": ["3B", "3B", "1I", "1I", "3F", "2H/Q", "2F"],
      },
      "KATIUSCIA ALVES BOMFIM": {
        "SEG": ["1A", "1A", "8A", "9C", "8B", "8C", "8E", "8E"],
        "TER": ["7C", "7A", "7A", "7D", "7D", "8B"],
        "QUA": ["9D", "9D", "9A", "9A", "7E", "7E"],
        "QUI": ["7B", "9B", "9C", "7B", "9B", "8A"],
        "SEX": ["8C", "7F", "7F", "8D", "8D", "7C"],
      },
      "LUANA CAROLINE ALVES LIMA": {
        "SEG": ["9C", "7A", "7A", "9A", "9B", "9B"],
        "TER": ["6D", "6B", "6A", "9C", "9C", "1G", "1G", "9D", "9D"],
        "QUA": ["6C", "6D", "6C", "9A", "9B", "9B", "9C", "1G", "1G"],
        "QUI": ["6A", "6B", "9D", "7A", "7A", "9D", "9A", "9A"],
      },
      "LUCIANA NOVAIS CORREIA SANTOS": {
        "SEG": ["3G", "3G", "3D", "3F", "3F"],
        "TER": ["1I", "1I", "3E", "3D", "3D"],
        "QUA": ["3E", "3F", "3F", "3G", "3G"],
        "QUI": ["3D", "1I", "1I", "3E", "3E"],
      },
      "LUCIANO MOREIRA DE AZEVEDO": {
        "SEG": ["8A", "8A", "8D", "9A", "9C"],
        "TER": ["7E", "8B", "9C", "7E"],
        "QUA": ["8C", "9B", "8B", "9D"],
        "QUI": ["7F", "7F", "8C", "7E", "9B"],
        "SEX": ["7F", "9D", "8D", "9A", "8E", "8E"],
      },
      "MARCIEL DA SILVA": {
        "SEG": ["7E", "7E", "7B", "9B/PV", "8C", "8C"],
        "TER": ["9A/PV", "8E", "8E", "8A", "7C", "7D"],
        "QUA": ["8C", "7D", "7F", "7F", "8D", "8D"],
        "QUI": ["9C/PV", "8D", "8E", "8B", "8B", "7B"],
        "SEX": ["8A", "8A", "8B", "7C", "7A", "7A", "3D", "3D"],
      },
      "MARINA DA CONCEICAO FRANCISCO SILVA": {
        "SEG": ["6B", "6A", "6B/EF", "6B/EF"],
        "TER": ["6D", "6D", "6D", "6B", "6A", "6B", "7A"],
        "QUA": ["6C", "6C", "6C", "6B", "6A/EF", "6A/EF", "7A", "7A"],
        "QUI": ["6D", "6D", "6A", "6D/EF", "6D/EF", "6A", "7A", "7B/EF", "7B/EF", "7A", "7A/EF", "7A/EF"],
        "SEX": ["6C", "6C", "6A", "6B", "6C/EF", "6C/EF"],
      },
      "MAURICIO DE BARROS SANTOS": {
        "SEG": ["2C/EF", "2A/EF", "2ADM/M.A", "2ADM/M.A", "2A/MAT"],
        "TER": ["2C/EF", "2B/EF", "2ADM/M", "2ADM/M"],
        "QUA": ["2A"],
        "QUI": ["2A"],
        "SEX": ["2A", "2A", "2ADM", "2ADM", "2ADM", "2B"],
      },
      "MOISES ANTONIO DE BARROS": {
        "SEG": ["3E", "3E", "3G", "3G", "3D"],
        "TER": ["3E/OM", "3G", "3G", "3F/OM", "3F/OM"],
        "QUA": ["3G/OM", "3D/OM", "3D/OM", "3F", "3F"],
        "QUI": ["2G/EF", "2G/EF", "3F/OM", "2F/EF", "2F/EF"],
        "SEX": ["3F", "3F", "3G", "3G"],
      },
      "PAULO ROBERTO DA SILVA ITO": {
        "SEG": ["2G", "1I", "2H", "2F"],
        "TER": ["2E", "2E", "2E/L", "2E/L", "6E", "6F", "8C"],
        "QUA": ["1F/FIL", "1F/FIL", "2D/OR", "2D/SOC", "2D/SOC", ""],
        "QUI": ["2B", "2B", "2C/OR", "2E/OR", "2C", "2C"],
        "SEX": ["2ADM", "2ADM", "1E/F", "1E/F", "2A/S", "2A/S", "2H", "2G", "2F"],
      },
      "PEDRO ZANOTTI FILHO": {
        "QUI": ["6F", "6F", "3F", "3G", "3E", "3G", "1I"],
        "SEX": ["1I", "3F", "3E"],
      },
      "REGINA DA SILVA CASTRO": {
        "SEG": ["9D", "9D", "7C", "7C", "8D", "8D"],
        "TER": ["9B", "9B", "9C", "9C", "9A", "9A"],
        "QUA": ["8E/R", "8E/R", "1G/R", "1G/R", "6E", "6E"],
        "QUI": ["7D/R", "6E", "6E", "8A/R", "8C/R", "8C/R"],
        "SEX": ["1A", "1A", "7D", "7B", "7B", "8B", "8B", "8A"],
      },
      "ROBERTO SALGADO": {
        "SEG": ["7E", "7F", "7C", "7D"],
        "TER": ["7F", "7C", "7D", "7B", "7F", "7C", "3G"],
        "QUA": ["7B", "7E", "7C", "7D", "7B", "7F", "1I/EF", "1I/EF", "3G/F", "2H/EF", "2H/EF"],
        "QUI": ["7E", "7F", "7E"],
        "SEX": ["7B", "7D", "7C", "7E", "7D", "7B"],
      },
      "RODRIGO VIEIRA": {
        "SEG": ["1D", "1D", "1C", "1C", "1F", "1F", "", "3D", "2G", "2F", "2H", "3G"],
        "TER": ["1B", "1B", "1A", "1A", "1E", "1E", "3F", "2G", "1I"],
        "QUA": ["3D", "3G", "3E"],
        "QUI": ["1I", "3F", "2H"],
        "SEX": ["3E", "2F"],
      },
      "ROSANGELA CAFASSO MOREIRA": {
        "SEG": ["1B", "1B", "2A", "2A", "2E", "2E"],
        "TER": ["1A", "1A", "1C", "1C", "2B", "2B"],
        "QUA": ["2A/PR", "2A/PR", "3A/PR", "3A/PR", "2C/Q", "2C/Q", "1G", "1G"],
        "QUI": ["3B/EM", "3B/EM", "2D/QU", "2D/QU", "2B/PR", "2B/PR"],
        "SEX": ["3B/P", "3B/P", "3A/EM", "3C/P", "3C/P", "3A/EM"],
      },
      "ROSMARA DA SILVA CARDOSO": {
        "SEG": ["6C", "1B"],
        "TER": ["6B", "6A", "1A", "6C"],
        "QUA": ["6D", "6A", "6D", "6D", "1B", "6B"],
        "QUI": ["6A", "6A", "6B", "1A", "6C", "1B"],
        "SEX": ["1A", "6B", "6C", "1A", "1B", "6D"],
      },
      "SELMA GOMES DA SILVA": {
        "SEG": ["1A", "1D", "1C"],
        "TER": ["1G/F"],
        "QUA": ["1B"],
        "QUI": ["1A", "1C", "1B", "1D", "1G/F"],
      },
      "SUZINEIDE SILVA DE FREITAS": {
        "SEG": ["1H", "2F", "2G"],
        "TER": ["6F", "6F", "1I", "2H"],
        "QUA": ["2ADM", "2ADM", "2B", "2B", "2E", "2E", "6E"],
        "QUI": ["2C", "2C", "2A", "2A", "2D", "2D", "6E"],
        "SEX": ["2ADM", "2ADM", "2ADM", "2ADM", "2ADM", "2ADM", "2ADM"],
      },
      "THIAGO FABIANO BRITO": {
        "SEG": ["1H", "1H", "1I", "1I"],
        "TER": ["1H", "1H", "1I", "1I"],
        "QUA": ["1H", "1H", "1I", "1I"],
        "QUI": ["1H", "1H", "1I", "1I"],
        "SEX": ["1H", "1H", "1I", "1I"],
      },
      "VANDERSON HYPPOLITO": {
        "SEG": ["3A", "3A", "3B", "3B", "3C", "3C"],
        "TER": ["3A", "3A", "3B", "3B", "3C", "3C"],
        "QUA": ["3A", "3A", "3B", "3B", "3C", "3C"],
        "QUI": ["3A", "3A", "3B", "3B", "3C", "3C"],
        "SEX": ["3A", "3A", "3B", "3B", "3C", "3C"],
      },
      "VIVIANE LEAL CAMERA DE MORAES": {
        "SEG": ["6E", "6F", "6E", "6F"],
        "TER": ["6E", "6F", "6E", "6F"],
        "QUA": ["6E", "6F", "6E", "6F"],
        "QUI": ["6E", "6F", "6E", "6F"],
        "SEX": ["6E", "6F", "6E", "6F"],
      },
      "WILSON LUIZ DE SOUZA COSTA": {
        "SEG": ["2ADM", "2ADM", "2ADM", "2ADM"],
        "TER": ["2ADM", "2ADM", "2ADM", "2ADM"],
        "QUA": ["2ADM", "2ADM", "2ADM", "2ADM"],
        "QUI": ["2ADM", "2ADM", "2ADM", "2ADM"],
        "SEX": ["2ADM", "2ADM", "2ADM", "2ADM"],
      },
      "WILSON RODRIGUES MOTA": {
        "SEG": ["1G", "1H", "1I"],
        "TER": ["1G", "1H", "1I"],
        "QUA": ["1G", "1H", "1I"],
        "QUI": ["1G", "1H", "1I"],
        "SEX": ["1G", "1H", "1I"],
      }
    };

    // Variáveis globais
    let agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
    let aulasSelecionadas = [];
    let currentDate = new Date();
    let selectedDate = null;
    let editingIndex = -1;

    // URL da planilha do Google Sheets
    const GOOGLE_SHEETS_URL = 'https://docs.google.com/spreadsheets/d/1f832KA3zaly5DnFU3MKLeg3J_L9xv4qb2AsfDrIrljo/edit?usp=drivesdk';

    // Inicialização
    document.addEventListener('DOMContentLoaded', function() {
      carregarProfessores();
      inicializarCalendario();
      inicializarDatepicker();
      carregarHistorico();
      inicializarModal();
    });

    // Função para carregar professores no dropdown
    function carregarProfessores() {
      const professorSelect = document.getElementById('professor');
      Object.keys(teacherEmails).forEach(professor => {
        const option = document.createElement('option');
        option.value = professor;
        option.textContent = professor;
        professorSelect.appendChild(option);
      });
    }

    // Função para atualizar email do professor
    function atualizarEmail() {
      const professorSelect = document.getElementById('professor');
      const emailInput = document.getElementById('email-professor');
      const professorSelecionado = professorSelect.value;
      
      if (teacherEmails[professorSelecionado]) {
        emailInput.value = teacherEmails[professorSelecionado];
      } else {
        emailInput.value = '';
      }
    }

    // Função para atualizar marca do aparelho
    function atualizarMarca() {
      const aparelhoSelect = document.getElementById('aparelho');
      const marcaInput = document.getElementById('marca');
      const aparelhoSelecionado = aparelhoSelect.value;
      
      if (marcas[aparelhoSelecionado]) {
        marcaInput.value = marcas[aparelhoSelecionado];
      } else {
        marcaInput.value = '';
      }
    }

    // Função para atualizar sala da turma
    function atualizarSala() {
      const turmaSelect = document.getElementById('studentClass');
      const salaInput = document.getElementById('sala');
      const turmaSelecionada = turmaSelect.value;
      
      if (salasPorTurmaPeriodo[turmaSelecionada]) {
        salaInput.value = salasPorTurmaPeriodo[turmaSelecionada];
      } else {
        salaInput.value = '';
      }
    }

    // Função para carregar aulas do professor
    function carregarAulasProfessor() {
      const professorSelect = document.getElementById('professor');
      const professorSelecionado = professorSelect.value;
      const container = document.getElementById('aulasProfessorContainer');
      const loading = document.getElementById('aulaLoading');
      
      // Limpar seleções anteriores
      aulasSelecionadas = [];
      atualizarAulasSelecionadas();
      
      if (!professorSelecionado || professorSelecionado === 'Selecione') {
        container.innerHTML = '';
        loading.style.display = 'none';
        return;
      }
      
      loading.style.display = 'block';
      
      setTimeout(() => {
        const horarios = horariosProfessores[professorSelecionado];
        container.innerHTML = '';
        
        if (horarios) {
          const diasSemana = ['SEG', 'TER', 'QUA', 'QUI', 'SEX'];
          
          diasSemana.forEach(dia => {
            if (horarios[dia] && horarios[dia].length > 0) {
              const periodoDiv = document.createElement('div');
              periodoDiv.className = 'periodo-aulas';
              
              const titleDiv = document.createElement('div');
              titleDiv.className = 'periodo-title';
              titleDiv.innerHTML = `
                ${dia}
                <button class="select-all-btn" onclick="selecionarTodasAulasDia('${dia}', '${professorSelecionado}')">
                  Selecionar Todas
                </button>
              `;
              
              const aulasGrid = document.createElement('div');
              aulasGrid.className = 'aulas-grid';
              
              horarios[dia].forEach((aula, index) => {
                if (aula && aula !== 'X') {
                  const aulaDiv = document.createElement('div');
                  aulaDiv.className = 'aula-option';
                  aulaDiv.textContent = `${index + 1}ª - ${aula}`;
                  aulaDiv.onclick = () => toggleAula(dia, index + 1, aula, aulaDiv);
                  aulasGrid.appendChild(aulaDiv);
                }
              });
              
              periodoDiv.appendChild(titleDiv);
              periodoDiv.appendChild(aulasGrid);
              container.appendChild(periodoDiv);
            }
          });
        }
        
        loading.style.display = 'none';
      }, 500);
    }

    // Função para selecionar todas as aulas de um dia
    function selecionarTodasAulasDia(dia, professor) {
      const horarios = horariosProfessores[professor];
      if (!horarios || !horarios[dia]) return;
      
      horarios[dia].forEach((aula, index) => {
        if (aula && aula !== 'X') {
          const aulaInfo = `${dia} - ${index + 1}ª - ${aula}`;
          if (!aulasSelecionadas.includes(aulaInfo)) {
            aulasSelecionadas.push(aulaInfo);
          }
        }
      });
      
      // Atualizar visual das aulas
      const aulasOptions = document.querySelectorAll('.aula-option');
      aulasOptions.forEach(option => {
        const texto = option.textContent;
        const aulaInfo = `${dia} - ${texto}`;
        if (aulasSelecionadas.includes(aulaInfo)) {
          option.classList.add('selected');
        }
      });
      
      atualizarAulasSelecionadas();
    }

    // Função para toggle de seleção de aula
    function toggleAula(dia, numero, turma, elemento) {
      const aulaInfo = `${dia} - ${numero}ª - ${turma}`;
      
      if (aulasSelecionadas.includes(aulaInfo)) {
        aulasSelecionadas = aulasSelecionadas.filter(aula => aula !== aulaInfo);
        elemento.classList.remove('selected');
      } else {
        aulasSelecionadas.push(aulaInfo);
        elemento.classList.add('selected');
      }
      
      atualizarAulasSelecionadas();
    }

    // Função para atualizar display das aulas selecionadas
    function atualizarAulasSelecionadas() {
      const container = document.getElementById('selectedAulasContainer');
      const lista = document.getElementById('selectedAulasList');
      
      if (aulasSelecionadas.length > 0) {
        container.style.display = 'block';
        lista.innerHTML = '';
        
        aulasSelecionadas.forEach((aula, index) => {
          const aulaDiv = document.createElement('div');
          aulaDiv.className = 'selected-aula';
          aulaDiv.textContent = aula;
          aulaDiv.onclick = () => removerAulaSelecionada(index);
          lista.appendChild(aulaDiv);
        });
      } else {
        container.style.display = 'none';
      }
    }

    // Função para remover aula selecionada
    function removerAulaSelecionada(index) {
      aulasSelecionadas.splice(index, 1);
      atualizarAulasSelecionadas();
      
      // Atualizar visual das opções
      const aulasOptions = document.querySelectorAll('.aula-option');
      aulasOptions.forEach(option => {
        option.classList.remove('selected');
      });
      
      aulasSelecionadas.forEach(aula => {
        aulasOptions.forEach(option => {
          const texto = option.textContent;
          const [dia] = aula.split(' - ');
          const aulaInfo = `${dia} - ${texto}`;
          if (aula === aulaInfo) {
            option.classList.add('selected');
          }
        });
      });
    }

    // Função para cadastrar agendamento
    function cadastrarAgendamento() {
      const professor = document.getElementById('professor').value;
      const aparelho = document.getElementById('aparelho').value;
      const numeroAparelhos = document.getElementById('numero-aparelhos').value;
      const data = document.getElementById('data-selecionada').value;
      const turma = document.getElementById('studentClass').value;
      const horaRetirada = document.getElementById('hora-retirada').value;
      const horaEntrega = document.getElementById('hora-entrega').value;
      
      // Validações
      if (!professor || professor === 'Selecione') {
        alert('Por favor, selecione um professor.');
        return;
      }
      
      if (!aparelho) {
        alert('Por favor, selecione um aparelho.');
        return;
      }
      
      if (!data) {
        alert('Por favor, selecione uma data.');
        return;
      }
      
      if (!turma) {
        alert('Por favor, selecione uma turma.');
        return;
      }
      
      if (!horaRetirada) {
        alert('Por favor, informe o horário de retirada.');
        return;
      }
      
      if (aulasSelecionadas.length === 0) {
        alert('Por favor, selecione pelo menos uma aula.');
        return;
      }
      
      // Verificar conflitos
      const conflito = verificarConflito(data, turma, aulasSelecionadas);
      if (conflito) {
        document.getElementById('conflictMessage').style.display = 'block';
        setTimeout(() => {
          document.getElementById('conflictMessage').style.display = 'none';
        }, 3000);
        return;
      }
      
      // Criar agendamento
      const agendamento = {
        id: Date.now(),
        data: data,
        turma: turma,
        numeroAparelhos: numeroAparelhos,
        aparelho: aparelho,
        marca: document.getElementById('marca').value,
        professor: professor,
        email: document.getElementById('email-professor').value,
        sala: document.getElementById('sala').value,
        horaRetirada: horaRetirada,
        horaEntrega: horaEntrega,
        aulas: [...aulasSelecionadas],
        entregue: false,
        timestamp: new Date().toISOString()
      };
      
      agendamentos.push(agendamento);
      localStorage.setItem('agendamentos', JSON.stringify(agendamentos));
      
      // Enviar para Google Sheets
      enviarParaGoogleSheets(agendamento);
      
      // Atualizar interface
      carregarHistorico();
      limparFormulario();
      
      alert('Agendamento cadastrado com sucesso!');
    }

    // Função para verificar conflitos
    function verificarConflito(data, turma, aulas) {
      return agendamentos.some(agendamento => 
        agendamento.data === data && 
        agendamento.turma === turma && 
        agendamento.aulas.some(aula => aulas.includes(aula))
      );
    }

    // Função para enviar dados para Google Sheets
    function enviarParaGoogleSheets(agendamento) {
      // Aqui você implementaria a integração com Google Sheets API
      // Por enquanto, apenas simularemos o envio
      console.log('Enviando para Google Sheets:', agendamento);
      
      // Exemplo de como seria a implementação real:
      /*
      const data = {
        values: [[
          agendamento.data,
          agendamento.turma,
          agendamento.numeroAparelhos,
          agendamento.aparelho,
          agendamento.professor,
          agendamento.aulas.join(', '),
          agendamento.entregue ? 'Sim' : 'Não'
        ]]
      };
      
      fetch('https://sheets.googleapis.com/v4/spreadsheets/1f832KA3zaly5DnFU3MKLeg3J_L9xv4qb2AsfDrIrljo/values/Sheet1!A:G:append?valueInputOption=RAW&key=YOUR_API_KEY', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
      });
      */
    }

    // Função para carregar histórico
    function carregarHistorico() {
      const tbody = document.getElementById('historico-body');
      tbody.innerHTML = '';
      
      agendamentos.forEach((agendamento, index) => {
        const tr = document.createElement('tr');
        tr.className = agendamento.entregue ? 'entregue' : 'nao-entregue';
        
        tr.innerHTML = `
          <td>${agendamento.data}</td>
          <td>${agendamento.turma}</td>
          <td>${agendamento.numeroAparelhos}</td>
          <td>${agendamento.aparelho}</td>
          <td>${agendamento.professor}</td>
          <td>${agendamento.aulas.join(', ')}</td>
          <td>
            <input type="checkbox" ${agendamento.entregue ? 'checked' : ''} 
                   onchange="toggleEntrega(${index})">
          </td>
          <td>
            <div class="action-icons">
              <div class="action-icon edit-icon" onclick="editarAgendamento(${index})" title="Editar">
                ✏️
              </div>
              <div class="action-icon delete-icon" onclick="excluirAgendamento(${index})" title="Excluir">
                🗑️
              </div>
            </div>
          </td>
        `;
        
        tbody.appendChild(tr);
      });
    }

    // Função para toggle de entrega
    function toggleEntrega(index) {
      agendamentos[index].entregue = !agendamentos[index].entregue;
      localStorage.setItem('agendamentos', JSON.stringify(agendamentos));
      carregarHistorico();
    }

    // Função para editar agendamento
    function editarAgendamento(index) {
      editingIndex = index;
      const agendamento = agendamentos[index];
      
      document.getElementById('editData').value = agendamento.data;
      document.getElementById('editTurma').value = agendamento.turma;
      document.getElementById('editNumAparelhos').value = agendamento.numeroAparelhos;
      document.getElementById('editAparelho').value = agendamento.aparelho;
      document.getElementById('editProfessor').value = agendamento.professor;
      document.getElementById('editAulas').value = agendamento.aulas.join(', ');
      
      document.getElementById('editModal').style.display = 'block';
    }

    // Função para salvar edição
    function salvarEdicao() {
      if (editingIndex === -1) return;
      
      const agendamento = agendamentos[editingIndex];
      agendamento.data = document.getElementById('editData').value;
      agendamento.turma = document.getElementById('editTurma').value;
      agendamento.numeroAparelhos = document.getElementById('editNumAparelhos').value;
      agendamento.aparelho = document.getElementById('editAparelho').value;
      agendamento.professor = document.getElementById('editProfessor').value;
      agendamento.aulas = document.getElementById('editAulas').value.split(', ');
      
      localStorage.setItem('agendamentos', JSON.stringify(agendamentos));
      carregarHistorico();
      fecharModal();
      
      alert('Agendamento atualizado com sucesso!');
    }

    // Função para excluir agendamento
    function excluirAgendamento(index) {
      if (confirm('Tem certeza que deseja excluir este agendamento?')) {
        agendamentos.splice(index, 1);
        localStorage.setItem('agendamentos', JSON.stringify(agendamentos));
        carregarHistorico();
        alert('Agendamento excluído com sucesso!');
      }
    }

    // Função para fechar modal
    function fecharModal() {
      document.getElementById('editModal').style.display = 'none';
      editingIndex = -1;
    }

    // Função para inicializar modal
    function inicializarModal() {
      const modal = document.getElementById('editModal');
      const span = document.getElementsByClassName('close')[0];
      
      span.onclick = fecharModal;
      
      window.onclick = function(event) {
        if (event.target == modal) {
          fecharModal();
        }
      }
    }

    // Função para limpar formulário
    function limparFormulario() {
      document.getElementById('professor').value = 'Selecione';
      document.getElementById('email-professor').value = '';
      document.getElementById('aparelho').value = '';
      document.getElementById('marca').value = '';
      document.getElementById('numero-aparelhos').value = '1';
      document.getElementById('data-selecionada').value = '';
      document.getElementById('studentClass').value = '';
      document.getElementById('sala').value = '';
      document.getElementById('hora-retirada').value = '';
      document.getElementById('hora-entrega').value = '';
      
      aulasSelecionadas = [];
      document.getElementById('aulasProfessorContainer').innerHTML = '';
      document.getElementById('selectedAulasContainer').style.display = 'none';
      document.getElementById('conflictMessage').style.display = 'none';
    }

    // Funções do calendário e datepicker (mantidas do código original)
    function inicializarCalendario() {
      const monthSelect = document.getElementById('monthSelect');
      const yearSelect = document.getElementById('yearSelect');
      
      // Preencher meses
      const meses = [
        'Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
        'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
      ];
      
      meses.forEach((mes, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = mes;
        monthSelect.appendChild(option);
      });
      
      // Preencher anos
      const currentYear = new Date().getFullYear();
      for (let year = currentYear - 1; year <= currentYear + 2; year++) {
        const option = document.createElement('option');
        option.value = year;
        option.textContent = year;
        yearSelect.appendChild(option);
      }
      
      monthSelect.value = currentDate.getMonth();
      yearSelect.value = currentDate.getFullYear();
      
      monthSelect.addEventListener('change', atualizarCalendario);
      yearSelect.addEventListener('change', atualizarCalendario);
      
      atualizarCalendario();
    }

    function atualizarCalendario() {
      const monthSelect = document.getElementById('monthSelect');
      const yearSelect = document.getElementById('yearSelect');
      const calendarBody = document.getElementById('calendarBody');
      
      const month = parseInt(monthSelect.value);
      const year = parseInt(yearSelect.value);
      
      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);
      const startDate = new Date(firstDay);
      startDate.setDate(startDate.getDate() - firstDay.getDay());
      
      calendarBody.innerHTML = '';
      
      for (let week = 0; week < 6; week++) {
        const row = document.createElement('tr');
        
        for (let day = 0; day < 7; day++) {
          const cell = document.createElement('td');
          const cellDate = new Date(startDate);
          cellDate.setDate(startDate.getDate() + (week * 7) + day);
          
          cell.textContent = cellDate.getDate();
          
          if (cellDate.getMonth() !== month) {
            cell.classList.add('indisponivel');
          } else {
            cell.classList.add('disponivel');
            cell.addEventListener('click', () => selecionarData(cellDate));
          }
          
          row.appendChild(cell);
        }
        
        calendarBody.appendChild(row);
      }
    }

    function selecionarData(date) {
      selectedDate = date;
      const dateString = date.toLocaleDateString('pt-BR');
      document.getElementById('data-selecionada').value = dateString;
      
      // Atualizar visual do calendário
      const cells = document.querySelectorAll('.calendar td');
      cells.forEach(cell => cell.classList.remove('selecionado'));
      
      const selectedCell = Array.from(cells).find(cell => 
        parseInt(cell.textContent) === date.getDate() && 
        !cell.classList.contains('indisponivel')
      );
      
      if (selectedCell) {
        selectedCell.classList.add('selecionado');
      }
    }

    function inicializarDatepicker() {
      const datepickerInput = document.getElementById('data-selecionada');
      const datepickerPopup = document.getElementById('datepickerPopup');
      
      datepickerInput.addEventListener('click', () => {
        datepickerPopup.classList.toggle('active');
        if (datepickerPopup.classList.contains('active')) {
          atualizarDatepicker();
        }
      });
      
      document.addEventListener('click', (e) => {
        if (!e.target.closest('.datepicker-container')) {
          datepickerPopup.classList.remove('active');
        }
      });
      
      document.getElementById('prevMonth').addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() - 1);
        atualizarDatepicker();
      });
      
      document.getElementById('nextMonth').addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() + 1);
        atualizarDatepicker();
      });
    }

    function atualizarDatepicker() {
      const monthYear = document.getElementById('datepickerMonthYear');
      const weekdays = document.getElementById('datepickerWeekdays');
      const days = document.getElementById('datepickerDays');
      
      const meses = [
        'Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
        'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
      ];
      
      monthYear.textContent = `${meses[currentDate.getMonth()]} ${currentDate.getFullYear()}`;
      
      // Dias da semana
      weekdays.innerHTML = '';
      const diasSemana = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];
      diasSemana.forEach(dia => {
        const div = document.createElement('div');
        div.className = 'datepicker-weekday';
        div.textContent = dia;
        weekdays.appendChild(div);
      });
      
      // Dias do mês
      days.innerHTML = '';
      const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
      const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
      const startDate = new Date(firstDay);
      startDate.setDate(startDate.getDate() - firstDay.getDay());
      
      for (let i = 0; i < 42; i++) {
        const cellDate = new Date(startDate);
        cellDate.setDate(startDate.getDate() + i);
        
        const div = document.createElement('div');
        div.className = 'datepicker-day';
        div.textContent = cellDate.getDate();
        
        if (cellDate.getMonth() !== currentDate.getMonth()) {
          div.classList.add('datepicker-other-month');
        }
        
        if (cellDate.toDateString() === new Date().toDateString()) {
          div.classList.add('datepicker-today');
        }
        
        if (selectedDate && cellDate.toDateString() === selectedDate.toDateString()) {
          div.classList.add('selected');
        }
        
        div.addEventListener('click', () => {
          selecionarDataDatepicker(cellDate);
        });
        
        days.appendChild(div);
      }
    }

    function selecionarDataDatepicker(date) {
      selectedDate = date;
      const dateString = date.toLocaleDateString('pt-BR');
      document.getElementById('data-selecionada').value = dateString;
      document.getElementById('datepickerPopup').classList.remove('active');
      
      // Atualizar calendário principal se necessário
      const monthSelect = document.getElementById('monthSelect');
      const yearSelect = document.getElementById('yearSelect');
      
      if (parseInt(monthSelect.value) !== date.getMonth() || 
          parseInt(yearSelect.value) !== date.getFullYear()) {
        monthSelect.value = date.getMonth();
        yearSelect.value = date.getFullYear();
        atualizarCalendario();
      }
      
      selecionarData(date);
    }

    function abrirRelogio(inputId) {
      document.getElementById(inputId).focus();
    }
  </script>
</body>
</html>
