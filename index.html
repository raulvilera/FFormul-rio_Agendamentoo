<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AGENDAMENTO DE APARELHOS</title>
  <style>
    :root {
      --azul-escuro: #0a2463;
      --azul-medio: #3e92cc;
      --azul-claro: #d6eaff;
      --verde: #4caf50;
      --vermelho: #f44336;
      --cinza-escuro: #333;
      --cinza-claro: #f5f5f5;
      --branco: #ffffff;
      --branco-brilhante: rgba(255, 255, 255, 0.9);
      --verde-disponivel: #2ecc71;
      --azul-agendado: #3498db;
      --azul-selecionado: #1a5276;
      --fundo-cinza: #f0f0f0;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    body {
      background: linear-gradient(to bottom, var(--azul-escuro) 0%, var(--azul-escuro) 50%, #111 50%, #111 100%);
      color: var(--cinza-claro);
      min-height: 100vh;
      padding: 20px;
    }

    h2 {
      color: var(--branco);
      margin-bottom: 20px;
      text-align: center;
      text-transform: uppercase;
    }

    h3 {
      color: #000000;
      margin: 0.4cm 0;
      text-align: center;
      text-transform: uppercase;
      font-size: 0.9em;
    }

    .container {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
    }

    .form-container {
      flex: 1;
      min-width: 300px;
      background-color: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      color: var(--cinza-escuro);
    }

    .calendar-container {
      flex: 1;
      min-width: 300px;
      background-color: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      color: var(--cinza-escuro);
    }

    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 1.5rem;
    }

    .form-group {
      flex: 1;
      min-width: 220px;
      position: relative;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: var(--azul-escuro);
    }

.form-group input,
.form-group select:not(#aula) {
  width: 100%;
  padding: 12px 15px;
  border: 2px solid var(--branco-brilhante);
  border-radius: 8px;
  font-size: 1rem;
  transition: all 0.3s ease;
  background-color: var(--branco);
}

/* Estilo específico para o campo "Aula" */
.form-group select#aula {
  width: 120px;
  padding: 8px 10px;
}

.form-group input[type="time"] {
  width: 120px; /* ou ajuste conforme necessário */
  padding: 8px 10px; /* opcional: reduzir padding para caber melhor */
}

    .form-group input:focus,
    .form-group select:focus {
      border-color: var(--azul-medio);
      box-shadow: 0 0 0 3px rgba(62, 146, 204, 0.2);
      outline: none;
    }

    /* Estilo para dropdown com cores alternadas */
    .form-group select option:nth-child(odd) {
      background-color: var(--azul-claro);
    }
    
    .form-group select option:nth-child(even) {
      background-color: var(--branco);
    }

    .calendar {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      margin-bottom: 0.4cm;
    }

    .calendar th,
    .calendar td {
      width: 40px;
      height: 40px;
      text-align: center;
      vertical-align: middle;
      border: 1px solid var(--branco-brilhante);
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      background-color: var(--branco);
      padding: 10px;
    }

    .calendar th {
      background-color: var(--azul-claro);
      border: 1px solid var(--branco-brilhante);
    }

    .calendar td.disponivel {
      background-color: var(--verde-disponivel);
      color: white;
      cursor: default;
      border: 1px solid var(--branco-brilhante);
    }

    .calendar td.agendado {
      background-color: var(--azul-agendado);
      color: white;
      border: 1px solid var(--branco-brilhante);
      cursor: default;
    }

    .calendar td.selecionado {
      background-color: var(--azul-selecionado);
      color: white;
      font-weight: bold;
      border: 1px solid var(--branco-brilhante);
      cursor: default;
    }

    .calendar td.indisponivel {
      background-color: #ccc;
      cursor: not-allowed;
      color: #666;
      border: 1px solid var(--branco-brilhante);
    }

    .calendar td:hover:not(.indisponivel) {
      opacity: 0.8;
    }

    /* Estilos para a tabela de histórico */
    .historico-table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }

    .historico-table th,
    .historico-table td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center; /* Centralizado */
      word-wrap: break-word;
      overflow-wrap: break-word;
      font-size: 0.8em;
      white-space: nowrap; /* Impede quebra de linha */
      overflow: hidden;
      text-overflow: ellipsis; /* Adiciona "..." se o texto for muito longo */
    }

    .historico-table th {
      background-color: var(--azul-claro);
      color: #000;
      font-weight: bold;
    }

    .historico-table td {
      color: #000;
    }

    .historico-table tr.excluido td {
      color: var(--vermelho);
    }

    /* Definindo larguras específicas para cada coluna */
    .historico-table th:nth-child(1),
    .historico-table td:nth-child(1) {
      width: 15%;
    }

    .historico-table th:nth-child(2),
    .historico-table td:nth-child(2) {
      width: 20%;
    }

    .historico-table th:nth-child(3),
    .historico-table td:nth-child(3) {
      width: 10%;
    }

    .historico-table th:nth-child(4),
    .historico-table td:nth-child(4) {
      width: 15%;
    }

    .historico-table th:nth-child(5),
    .historico-table td:nth-child(5) {
      width: 25%;
    }

    .historico-table th:nth-child(6),
    .historico-table td:nth-child(6) {
      width: 15%;
    }

    /* Estilos para os botões */
    .buttons-container {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
    }

    .btn:active {
      transform: translateY(2px);
      box-shadow: 0 2px 3px rgba(0, 0, 0, 0.1);
    }

    .btn-cadastrar {
      background-color: var(--azul-medio);
      color: white;
    }

    .btn-cadastrar:hover {
      background-color: #2c7ebd;
    }

    .btn-cadastrar:active {
      box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.2);
    }

    .btn-limpar {
      background-color: #f0f0f0;
      color: #333;
    }

    .btn-limpar:hover {
      background-color: #e0e0e0;
    }

    .btn-limpar:active {
      box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.2);
    }

    .btn-excluir {
      background-color: var(--vermelho);
      color: white;
    }

    .btn-excluir:hover {
      background-color: #d32f2f;
    }

    .btn-excluir:active {
      box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.2);
    }

    /* Estilos para o calendário pop-up */
    .datepicker-container {
      position: relative;
    }

    .datepicker-popup {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      z-index: 1000;
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      width: 300px;
    }

    .datepicker-popup.active {
      display: block;
    }

    .datepicker-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .datepicker-nav {
      background: none;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
    }

    .datepicker-title {
      font-weight: bold;
    }

    .datepicker-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }

    .datepicker-weekday {
      text-align: center;
      font-weight: bold;
      padding: 5px;
    }

    .datepicker-day {
      text-align: center;
      padding: 5px;
      cursor: pointer;
      border-radius: 4px;
    }

    .datepicker-day:hover {
      background-color: var(--azul-claro);
    }

    .datepicker-day.selected {
      background-color: var(--azul-medio);
      color: white;
    }

    .datepicker-day.disabled {
      color: #ccc;
      cursor: not-allowed;
    }

    .datepicker-today {
      font-weight: bold;
    }

    .datepicker-other-month {
      color: #aaa;
    }

    .datepicker-input {
      cursor: pointer;
    }

    .conflict-message {
      color: var(--vermelho);
      font-weight: bold;
      margin-top: 10px;
      text-align: center;
      display: none;
    }
  </style>
</head>
<body>
  <h2>AGENDAMENTO DE APARELHOS</h2>
  <div class="container">
    <div class="form-container">
      <div class="form-row">
        <div class="form-group">
          <label>PROFESSOR:</label>
          <select id="professor" onchange="atualizarEmail()">
            <option>Selecione</option>
          </select>
        </div>
        <div class="form-group">
          <label>EMAIL:</label>
          <input type="email" id="email-professor" readonly>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>APARELHO:</label>
          <select id="aparelho" onchange="atualizarMarca()">
            <option value="">Selecione</option>
            <option value="TABLET">TABLET</option>
            <option value="SMARTPHONE">SMARTPHONE</option>
            <option value="CHROMEBOOK">CHROMEBOOK</option>
            <option value="NOTEBOOK">NOTEBOOK</option>
          </select>
        </div>

        <div class="form-group">
          <label>MARCA:</label>
          <input type="text" id="marca" readonly>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>N° DE APARELHOS:</label>
          <input type="number" id="numero-aparelhos" min="1" value="1">
        </div>
        
        <div class="form-group datepicker-container">
          <label>DATA:</label>
          <input type="text" id="data-selecionada" class="datepicker-input" readonly placeholder="Clique para selecionar">
          <div class="datepicker-popup" id="datepickerPopup">
            <div class="datepicker-header">
              <button class="datepicker-nav" id="prevMonth">&lt;</button>
              <div class="datepicker-title" id="datepickerMonthYear"></div>
              <button class="datepicker-nav" id="nextMonth">&gt;</button>
            </div>
            <div class="datepicker-grid" id="datepickerWeekdays"></div>
            <div class="datepicker-grid" id="datepickerDays"></div>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>SELECIONE A TURMA:</label>
          <select id="studentClass" class="form-control" required onchange="atualizarSala()">
            <option value="">Selecione a turma</option>
            <option value="6° ANO A MANHA">6° ANO A MANHA</option>
            <option value="6° ANO B MANHA">6° ANO B MANHA</option>
            <option value="6° ANO C MANHA">6° ANO C MANHA</option>
            <option value="6° ANO D MANHA">6° ANO D MANHA</option>
            <option value="6° ANO E TARDE">6° ANO E TARDE</option>
            <option value="6° ANO F TARDE">6° ANO F TARDE</option>
            <option value="7° ANO A TARDE">7° ANO A TARDE</option>
            <option value="7° ANO B TARDE">7° ANO B TARDE</option>
            <option value="7° ANO C TARDE">7° ANO C TARDE</option>
            <option value="7° ANO D TARDE">7° ANO D TARDE</option>
            <option value="7° ANO E TARDE">7° ANO E TARDE</option>
            <option value="7° ANO F TARDE">7° ANO F TARDE</option>
            <option value="8° ANO A TARDE">8° ANO A TARDE</option>
            <option value="8° ANO B TARDE">8° ANO B TARDE</option>
            <option value="8° ANO C TARDE">8° ANO C TARDE</option>
            <option value="8° ANO D TARDE">8° ANO D TARDE</option>
            <option value="8° ANO E TARDE">8° ANO E TARDE</option>
            <option value="9° ANO A TARDE">9° ANO A TARDE</option>
            <option value="9° ANO B TARDE">9° ANO B TARDE</option>
            <option value="9° ANO C TARDE">9° ANO C TARDE</option>
            <option value="9° ANO D TARDE">9° ANO D TARDE</option>
            <option value="1ª SERIE A MANHA">1ª SERIE A MANHA</option>
            <option value="1ª SERIE B MANHA">1ª SERIE B MANHA</option>
            <option value="1ª SERIE C MANHA">1ª SERIE C MANHA</option>
            <option value="1ª SERIE D MANHA">1ª SERIE D MANHA</option>
            <option value="1ª SERIE E MANHA">1ª SERIE E MANHA</option>
            <option value="1ª SERIE F MANHA">1ª SERIE F MANHA</option>
            <option value="1ª SERIE G TARDE">1ª SERIE G TARDE</option>
            <option value="1ª SERIE H NOITE">1ª SERIE H NOITE</option>
            <option value="1ª SERIE I NOITE">1ª SERIE I NOITE</option>
            <option value="2ª SERIE A MANHA">2ª SERIE A MANHA</option>
            <option value="2ª SERIE B MANHA">2ª SERIE B MANHA</option>
            <option value="2ª SERIE C MANHA">2ª SERIE C MANHA</option>
            <option value="2ª SERIE D MANHA">2ª SERIE D MANHA</option>
            <option value="2ª SERIE E MANHA">2ª SERIE E MANHA</option>
            <option value="2ª SERIE F NOITE">2ª SERIE F NOITE</option>
            <option value="2ª SERIE G NOITE">2ª SERIE G NOITE</option>
            <option value="2ª SERIE H NOITE">2ª SERIE H NOITE</option>
            <option value="2ª SERIE I NOITE">2ª SERIE I NOITE</option>
            <option value="3ª SERIE A MANHA">3ª SERIE A MANHA</option>
            <option value="3ª SERIE B MANHA">3ª SERIE B MANHA</option>
            <option value="3ª SERIE C MANHA">3ª SERIE C MANHA</option>
            <option value="3ª SERIE D NOITE">3ª SERIE D NOITE</option>
            <option value="3ª SERIE E NOITE">3ª SERIE E NOITE</option>
            <option value="3ª SERIE F NOITE">3ª SERIE F NOITE</option>
            <option value="3ª SERIE G NOITE">3ª SERIE G NOITE</option>
            <option value="4050 - ADMINISTRAÇÃO - 2ª SERIE A MANHA">4050 - ADMINISTRAÇÃO - 2ª SERIE A MANHA</option>
          </select>
        </div>

        <div class="form-group">
          <label>SALA:</label>
          <input type="text" id="sala" readonly>
        </div>
      </div>

     <div class="form-row">
  <div class="form-group" onclick="abrirRelogio('hora-retirada')" style="cursor: pointer;">
    <label for="hora-retirada">RETIRADA:</label>
    <input type="time" id="hora-retirada">
  </div>
</div>


      <div class="form-group" onclick="abrirRelogio('hora-entrega')" style="cursor: pointer;">
  <label for="hora-entrega">ENTREGA:</label>
  <input type="time" id="hora-entrega">
</div>


    <div class="form-group">
  <label for="aula">Aula:</label>
  <select id="aula">
    <option>1ª Aula</option>
    <option>2ª Aula</option>
    <option>3ª Aula</option>
    <option>4ª Aula</option>
    <option>5ª Aula</option>
    <option>6ª Aula</option>
  </select>
</div>

      <div class="conflict-message" id="conflictMessage">
        Já existe um agendamento para esta turma nesta data e aula!
      </div>

      <div class="buttons-container">
        <button class="btn btn-cadastrar" onclick="cadastrarAgendamento()">CADASTRAR</button>
        <button class="btn btn-limpar" onclick="limparFormulario()">LIMPAR</button>
      </div>
    </div>

    <div class="calendar-container">
      <div style="margin-bottom: 20px;">
        <select id="monthSelect"></select>
        <select id="yearSelect"></select>
      </div>

      <table class="calendar">
        <thead>
          <tr>
            <th>Seg</th>
            <th>Ter</th>
            <th>Qua</th>
            <th>Qui</th>
            <th>Sex</th>
          </tr>
        </thead>
        <tbody id="calendarBody">
          <!-- Dias úteis serão inseridos via JavaScript -->
        </tbody>
      </table>

      <h3>HISTÓRICO DE AGENDAMENTOS</h3>
      <table class="historico-table">
        <thead>
          <tr>
            <th>DATA</th>
            <th>TURMA</th>
            <th>N° APARELHOS</th>
            <th>APARELHO</th>
            <th>PROFESSOR</th>
            <th>AULA(s)</th>
            <th>AÇÃO</th>
          </tr>
        </thead>
        <tbody id="historico-body">
          <!-- Histórico dinâmico -->
        </tbody>
      </table>
    </div>
  </div>

  <script>
    // Dados dos professores
    const teacherEmails = {
      "ADEMAR RIBEIRO DE SOUZA": "ademarribeirosouza@prof.educacao.sp.gov.br",
      "ALEX LUTH PEREIRA MARANHAO": "luth@prof.educacao.sp.gov.br",
      "ALEXANDRE SILVA LIMA": "alexandresilvalima@prof.educacao.sp.gov.br",
      "ALEXSANDRA PAULA VARELLA DE SOUZA": "avarella@prof.educacao.sp.gov.br",
      "ALINE CARDOSO": "aline.cardoso@servidor.educacao.sp.gov.br",
      "ALISON VASCONCELOS BESERRA": "alisonv@prof.educacao.sp.gov.br",
      "AMAURI TEODORO DE OLIVEIRA": "amaurit@prof.educacao.sp.gov.br",
      "ANA PAULA DE OLIVEIRA SOUZA": "ana.souza59@servidor.educacao.sp.gov.br",
      "ANA PAULA DOS SANTOS": "paulasantosa@prof.educacao.sp.gov.br",
      "ANDRE LUIZ TAVARES": "andreltavares@prof.educacao.sp.gov.br",
      "ANDREIA DOS SANTOS FREITAS": "sanfreitas@prof.educacao.sp.gov.br",
      "ANDREIA MADUREIRA REIS": "andreiamadureira@prof.educacao.sp.gov.br",
      "ANTONIO CARLS DE OLIVEIRA": "antoniocarloso@prof.educacao.sp.gov.br",
      "ANTONIO RAMOS DE ARAUJO": "antonioramosaraujo@prof.educacao.sp.gov.br",
      "ANTONIO WILTON WANDERLEY CABRAL": "antoniowilton@prof.educacao.sp.gov.br",
      "AUGUSTO LINO PESSOA NETO": "augustolino@prof.educacao.sp.gov.br",
      "AUREA MARIA DE JESUS MARQUES": "aureamaria@prof.educacao.sp.gov.br",
      "CAROLINA PERNOMIAN PARUSSOLO": "carolinapernomian@prof.educacao.sp.gov.br",
      "CASSIA OLIVEIRA ANTONIAZI": "cassiaosilva@prof.educacao.sp.gov.br",
      "CICERO FERREIRA": "cicero.ferreira@servidor.educacao.sp.gov.br",
      "DANIEL DE FREITAS ALMEIDA": "danielalmeida@prof.educacao.sp.gov.br",
      "DANIEL LOPES BARBOSA": "daniellopesbarbosa@prof.educacao.sp.gov.br",
      "DANIELA FERREIRA LIMA": "danielaflima@prof.educacao.sp.gov.br",
      "EDIANE VIEIRA DA SILVA": "ediane@prof.educacao.sp.gov.br",
      "EDILEUSA NUNES PEREIRA": "edileusa@prof.educacao.sp.gov.br",
      "EDUARDO HENRIQUE DA FONSECA": "henriquefonseca@prof.educacao.sp.gov.br",
      "ELIANE SANTOS SILVA": "essantos@prof.educacao.sp.gov.br",
      "ELIAS MONTEIRO DA SILVA": "elias1@prof.educacao.sp.gov.br",
      "ELISABETE APARECIDA PIRES": "elisabetepires@prof.educacao.sp.gov.br",
      "ELZA DE FARIA PEREIRA": "elzafariapereira@prof.educacao.sp.gov.br",
      "EMERSON GABLER DE ALMEIDA": "egabler@prof.educacao.sp.gov.br",
      "ERINEIDE LEITE ARAGAO NERY": "erineidearagao@prof.educacao.sp.gov.br",
      "EUZELI ARAUJO DE OLIVEIRA": "euzeli@prof.educacao.sp.gov.br",
      "FABIANO AUGUSTO PIEDADE": "fabianoaugusto@prof.educacao.sp.gov.br",
      "FABIO CAMILO": "camilof@prof.educacao.sp.gov.br",
      "FERNANDO JOSE DA SILVA FILHO": "fernandojs@prof.educacao.sp.gov.br",
      "FLAVIA CRISTINA APARECIDA BICHLER": "flaviacri@prof.educacao.sp.gov.br",
      "FLAVIO CARDOSO FLEURY": "flaviofleury@prof.educacao.sp.gov.br",
      "GABRIELA SERIGHELLI DE MELO": "gabrielaserighelli@prof.educacao.sp.gov.br",
      "GENILTON DE OLIVEIRA SILVA": "genilton@prof.educacao.sp.gov.br",
      "GIANI CRISTINA DO PRADO": "gianiprado@prof.educacao.sp.gov.br",
      "INGRYD CAROLINA SUGUIMOTO VIEIRA": "ingryd@prof.educacao.sp.gov.br",
      "IVANILDES DOS SANTOS OSHIKAWA": "oshikawa@prof.educacao.sp.gov.br",
      "JANINA DOS PASSOS BRAGA DE ALMEIDA": "janinabraga@prof.educacao.sp.gov.br",
      "JUAREZ GOMES DE MAGALHAES FILHO": "juarezgomes@prof.educacao.sp.gov.br",
      "JUREMA SOLEDADE FURINI SANTOS": "juremas@prof.educacao.sp.gov.br",
      "KATIUSCIA ALVES BOMFIM": "katiusciabomfim@prof.educacao.sp.gov.br",
      "KETHY REGINA DA SILVA DOMINGOS COSTA": "kethy@prof.educacao.sp.gov.br",
      "LUANA CAROLINE ALVES LIMA": "luanalima01@prof.educacao.sp.gov.br",
      "LUANA DE FREITAS SILVA": "luanafreitas@prof.educacao.sp.gov.br",
      "LUCIANA NOVAIS CORREIA SANTOS": "novaiscorreia@prof.educacao.sp.gov.br",
      "LUCIANO MOREIRA DE AZEVEDO": "lucianomoreira@prof.educacao.sp.gov.br",
      "MARCELO FERNANDES DA SILVA": "marcelofs@prof.educacao.sp.gov.br",
      "MARCIEL DA SILVA": "marcielsilva@prof.educacao.sp.gov.br",
      "MARIA HELENA CUNHA MORO": "marcunha@prof.educacao.sp.gov.br",
      "MARIA QUITÉRIA FERREIRA DOS SANTOS": "quiteriasantos@prof.educacao.sp.gov.br",
      "MARINA DA CONCEICAO FRANCISCO SILVA": "marinafrancisco@prof.educacao.sp.gov.br",
      "MAURICIO DE BARROS SANTOS": "mauriciobsantos@prof.educacao.sp.gov.br",
      "MICHELE DE PINHO MORAES": "michelepinho@prof.educacao.sp.gov.br",
      "MOISES ANTONIO DE BARROS": "moisesbarros@prof.educacao.sp.gov.br",
      "PATRICIA GOMES ROCHA RIBEIRO": "patriciag@prof.educacao.sp.gov.br",
      "PAULO ROBERTO DA SILVA ITO": "pauloito@prof.educacao.sp.gov.br",
      "PEDRO ZANOTTI FILHO": "pedrozanotti@prof.educacao.sp.gov.br",
      "RAUL PEREIRA VILERA JUNIOR": "vilera@prof.educacao.sp.gov.br",
      "REGIANE CURTI DE SOUZA OLIVEIRA": "regianecurti@prof.educacao.sp.gov.br",
      "REGINA DA SILVA CASTRO": "reginasilvacastro@prof.educacao.sp.gov.br",
      "RICARDO AMERICO DA SILVA": "ricardoamerico@prof.educacao.sp.gov.br",
      "ROBERTO SALGADO": "robertosalgado@prof.educacao.sp.gov.br",
      "RODRIGO VIEIRA": "rodrigovieira1@prof.educacao.sp.gov.br",
      "ROSANGELA CAFASSO MOREIRA": "cafasso@prof.educacao.sp.gov.br",
      "ROSIMERY DE SOUZA PESSOA": "rosimerypessoa@prof.educacao.sp.gov.br",
      "ROSMARA DA SILVA CARDOSO": "rosmaracardoso@prof.educacao.sp.gov.br",
      "SANDRA CRISTINA MACEDO MORAES": "sandracristinamacedo@prof.educacao.sp.gov.br",
      "SELMA GOMES DA SILVA": "selmagomess@prof.educacao.sp.gov.br",
      "SERGIO AGRIPINO VILLA NOVA": "sergioagripino@prof.educacao.sp.gov.br",
      "SOLANGE ALMEIDA DA SILVA": "almeidafazio@prof.educacao.sp.gov.br",
      "SUELI SILVE PEREIRA": "suelisilve@prof.educacao.sp.gov.br",
      "SUZINEIDE SILVA DE FREITAS": "suzineidefreitas@prof.educacao.sp.gov.br",
      "THIAGO FABIANO BRITO": "thiagofabiano@prof.educacao.sp.gov.br",
      "TITTO AUGUSTO NASCIMENTO SILVA": "titto@prof.educacao.sp.gov.br",
      "VANDERSON HYPPOLITO": "vhypolito@prof.educacao.sp.gov.br",
      "VANESSA IVETE GOMES DOS SANTOS": "vanessaivete@prof.educacao.sp.gov.br",
      "VANIA PENHA DE BARROS": "vaniapenha@prof.educacao.sp.gov.br",
      "VIVIANE LEAL CAMERA DE MORAES": "camera@prof.educacao.sp.gov.br",
      "WILSON LUIZ DE SOUZA COSTA": "wilsonluizsouza@prof.educacao.sp.gov.br",
      "WILSON RODRIGUES MOTA": "wmota@prof.educacao.sp.gov.br"
    };

    // Dados dos aparelhos
    const marcas = {
      "TABLET": "POSITIVO",
      "SMARTPHONE": "POSITIVO",
      "CHROMEBOOK": "SAMSUNG",
      "NOTEBOOK": "POSITIVO"
    };

    // Dados das salas por turma e período
    const salasPorTurmaPeriodo = {
      // 6° ANO
      "6° ANO A MANHA": "Sala 1",
      "6° ANO B MANHA": "Sala 2",
      "6° ANO C MANHA": "Sala 3",
      "6° ANO D MANHA": "Sala 4",
      "6° ANO E TARDE": "Sala 1",
      "6° ANO F TARDE": "Sala 2",
      
      // 7° ANO
      "7° ANO A TARDE": "Sala 3",
      "7° ANO B TARDE": "Sala 4",
      "7° ANO C TARDE": "Sala 5",
      "7° ANO D TARDE": "Sala 6",
      "7° ANO E TARDE": "Sala 7",
      "7° ANO F TARDE": "Sala 8",
      
      // 8° ANO
      "8° ANO A TARDE": "Sala 10",
      "8° ANO B TARDE": "Sala 11",
      "8° ANO C TARDE": "Sala 12",
      "8° ANO D TARDE": "Sala 13",
      "8° ANO E TARDE": "Sala 14",
      
      // 9° ANO
      "9° ANO A TARDE": "Sala 15",
      "9° ANO B TARDE": "Sala 16",
      "9° ANO C TARDE": "Sala 17",
      "9° ANO D TARDE": "Sala 18",
      
      // 1ª SÉRIE
      "1ª SERIE A MANHA": "Sala 10",
      "1ª SERIE B MANHA": "Sala 11",
      "1ª SERIE C MANHA": "Sala 12",
      "1ª SERIE D MANHA": "Sala 13",
      "1ª SERIE E MANHA": "Sala 14",
      "1ª SERIE F MANHA": "Sala 15",
      "1ª SERIE G TARDE": "Sala 9",
      "1ª SERIE H NOITE": "Sala 9",
      "1ª SERIE I NOITE": "Sala 602",
      
      // 2ª SÉRIE
      "2ª SERIE A MANHA": "Sala 5",
      "2ª SERIE B MANHA": "Sala 6",
      "2ª SERIE C MANHA": "Sala 7",
      "2ª SERIE D MANHA": "Sala 8",
      "2ª SERIE E MANHA": "Sala 9",
      "2ª SERIE F NOITE": "Sala 1",
      "2ª SERIE G NOITE": "Sala 2",
      "2ª SERIE H NOITE": "Sala 3",
      "2ª SERIE I NOITE": "Sala 4",
      
      // 3ª SÉRIE
      "3ª SERIE A MANHA": "Sala 16",
      "3ª SERIE B MANHA": "Sala 17",
      "3ª SERIE C MANHA": "Sala 18",
      "3ª SERIE D NOITE": "Sala 5",
      "3ª SERIE E NOITE": "Sala 6",
      "3ª SERIE F NOITE": "Sala 7",
      "3ª SERIE G NOITE": "Sala 8",
      
      // ADMINISTRAÇÃO
      "4050 - ADMINISTRAÇÃO - 2ª SERIE A MANHA": "Laboratório 1"
    };

    // Agendamentos e histórico (incluindo agendamentos excluídos)
    const agendamentos = {};
    const historicoExcluidos = [];

    const monthNames = [
      "Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho",
      "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"
    ];

    const weekdays = ['Seg', 'Ter', 'Qua', 'Qui', 'Sex'];

    const monthSelect = document.getElementById('monthSelect');
    const yearSelect = document.getElementById('yearSelect');
    let selectedDay = null;
    let selectedDate = null;

    // Variáveis para o calendário pop-up
    let currentPopupDate = new Date();
    let popupSelectedDate = null;

    // Função para verificar conflito de agendamento
    function verificarConflitoAgendamento(turma, data, aula) {
      const [dia, mes, ano] = data.split('/');
      const key = `${ano}-${mes}`;
      
      if (!agendamentos[key]) return false;
      
      return agendamentos[key].some(agendamento => 
        agendamento.dia === parseInt(dia) && 
        agendamento.turma === turma && 
        agendamento.aula === aula
      );
    }

    // Funções do formulário
    function atualizarMarca() {
      const tipo = document.getElementById("aparelho").value;
      document.getElementById("marca").value = marcas[tipo] || "";
    }

    function atualizarSala() {
      const turma = document.getElementById("studentClass").value;
      const periodo = turma.includes("MANHA") ? "MANHA" : 
                     turma.includes("TARDE") ? "TARDE" : 
                     turma.includes("NOITE") ? "NOITE" : "";
      
      // Verifica se a turma existe no mapeamento
      if (salasPorTurmaPeriodo[turma]) {
        document.getElementById("sala").value = salasPorTurmaPeriodo[turma];
      } else {
        document.getElementById("sala").value = "Sala não definida";
      }
      
      // Verifica se há conflito de agendamento
      verificarConflito();
    }

    function abrirRelogio(idCampo) {
  const campo = document.getElementById(idCampo);
  if (campo && typeof campo.showPicker === 'function') {
    campo.showPicker(); // Preferencial: abre diretamente o relógio (Chrome, Edge)
  } else {
    campo.focus(); // Fallback: para navegadores que não suportam showPicker
  }
}


    function atualizarEmail() {
      const nome = document.getElementById("professor").value;
      document.getElementById("email-professor").value = teacherEmails[nome] || "";
    }

    function gerarOpcoesProfessores() {
      const select = document.getElementById("professor");
      Object.keys(teacherEmails).forEach(nome => {
        const option = document.createElement("option");
        option.value = nome;
        option.textContent = nome;
        select.appendChild(option);
      });
    }

    // Função para verificar conflito quando os campos relevantes mudam
    function verificarConflito() {
      const turma = document.getElementById("studentClass").value;
      const data = document.getElementById("data-selecionada").value;
      const aula = document.getElementById("aula").value;
      const conflictMessage = document.getElementById("conflictMessage");
      
      if (turma && data && aula) {
        const conflito = verificarConflitoAgendamento(turma, data, aula);
        conflictMessage.style.display = conflito ? "block" : "none";
      } else {
        conflictMessage.style.display = "none";
      }
    }

    // Funções do calendário pop-up
    function initDatepicker() {
      const datepickerInput = document.getElementById('data-selecionada');
      const datepickerPopup = document.getElementById('datepickerPopup');
      const prevMonthBtn = document.getElementById('prevMonth');
      const nextMonthBtn = document.getElementById('nextMonth');
      const datepickerMonthYear = document.getElementById('datepickerMonthYear');
      const datepickerWeekdays = document.getElementById('datepickerWeekdays');
      const datepickerDays = document.getElementById('datepickerDays');

      // Preenche os dias da semana (apenas dias úteis)
      datepickerWeekdays.innerHTML = weekdays.map(day => 
        `<div class="datepicker-weekday">${day}</div>`
      ).join('');

      // Mostra/oculta o popup
      datepickerInput.addEventListener('click', () => {
        datepickerPopup.classList.toggle('active');
        renderDatepicker();
      });

      // Navegação do calendário
      prevMonthBtn.addEventListener('click', () => {
        currentPopupDate.setMonth(currentPopupDate.getMonth() - 1);
        renderDatepicker();
      });

      nextMonthBtn.addEventListener('click', () => {
        currentPopupDate.setMonth(currentPopupDate.getMonth() + 1);
        renderDatepicker();
      });

      // Fecha o popup quando clicar fora
      document.addEventListener('click', (e) => {
        if (!datepickerPopup.contains(e.target) && e.target !== datepickerInput) {
          datepickerPopup.classList.remove('active');
        }
      });

      function renderDatepicker() {
        const year = currentPopupDate.getFullYear();
        const month = currentPopupDate.getMonth();
        
        datepickerMonthYear.textContent = `${monthNames[month]} ${year}`;
        
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const daysInPrevMonth = new Date(year, month, 0).getDate();
        
        let daysHtml = '';
        const today = new Date();
        
        // Dias do mês atual
        for (let i = 1; i <= daysInMonth; i++) {
          const date = new Date(year, month, i);
          const dayOfWeek = date.getDay(); // 0=Domingo, 1=Segunda, ..., 6=Sábado
          
          // Mostrar apenas dias úteis (Segunda a Sexta)
          if (dayOfWeek >= 1 && dayOfWeek <= 5) {
            const isToday = date.toDateString() === today.toDateString();
            const isSelected = popupSelectedDate && date.toDateString() === popupSelectedDate.toDateString();
            const isPast = date < new Date(today.getFullYear(), today.getMonth(), today.getDate());
            
            let dayClass = 'datepicker-day';
            if (isToday) dayClass += ' datepicker-today';
            if (isSelected) dayClass += ' selected';
            if (isPast) dayClass += ' disabled';
            
            daysHtml += `<div class="${dayClass}" data-day="${i}">${i}</div>`;
          }
        }
        
        datepickerDays.innerHTML = daysHtml;
        
        // Adiciona eventos aos dias
        document.querySelectorAll('.datepicker-day:not(.disabled)').forEach(day => {
          day.addEventListener('click', () => {
            const dayNum = parseInt(day.getAttribute('data-day'));
            popupSelectedDate = new Date(year, month, dayNum);
            
            // Atualiza o campo de data
            const formattedDay = String(dayNum).padStart(2, '0');
            const formattedMonth = String(month + 1).padStart(2, '0');
            selectedDate = `${formattedDay}/${formattedMonth}/${year}`;
            datepickerInput.value = selectedDate;
            
            // Fecha o popup
            datepickerPopup.classList.remove('active');
            
            // Atualiza o calendário principal
            updateMainCalendarSelection(year, month + 1, dayNum);
            
            // Verifica se há conflito
            verificarConflito();
          });
        });
      }
    }

    function updateMainCalendarSelection(year, month, day) {
      // Atualiza os seletores de mês/ano se necessário
      if (parseInt(yearSelect.value) !== year || parseInt(monthSelect.value) + 1 !== month) {
        yearSelect.value = year;
        monthSelect.value = month - 1;
        renderCalendarBody(year, month - 1);
      }
      
      // Encontra e seleciona o dia no calendário principal
      const calendarBody = document.getElementById('calendarBody');
      const cells = calendarBody.querySelectorAll('td');
      
      cells.forEach(cell => {
        if (parseInt(cell.textContent) === day) {
          // Remove seleção anterior
          if (selectedDay) {
            selectedDay.classList.remove('selecionado');
            const agendamentosDoMes = getAgendamentos(parseInt(yearSelect.value), parseInt(monthSelect.value));
            if (!agendamentosDoMes.find(d => d.dia === parseInt(selectedDay.textContent))) {
              selectedDay.classList.add('disponivel');
            }
          }
          
          // Adiciona nova seleção
          cell.classList.add('selecionado');
          cell.classList.remove('disponivel');
          selectedDay = cell;
        }
      });
    }

    // Funções do calendário principal
    function populateMonthYearSelectors() {
      const currentYear = new Date().getFullYear();

      for (let y = currentYear - 1; y <= currentYear + 2; y++) {
        const option = document.createElement('option');
        option.value = y;
        option.textContent = y;
        yearSelect.appendChild(option);
      }

      monthNames.forEach((name, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = name;
        monthSelect.appendChild(option);
      });

      const now = new Date();
      monthSelect.value = now.getMonth();
      yearSelect.value = now.getFullYear();
    }

    function getAgendamentos(year, month) {
      const key = `${year}-${String(month + 1).padStart(2, '0')}`;
      return agendamentos[key] || [];
    }

    function renderHistorico(agendamentosDoMes) {
      const historicoBody = document.getElementById('historico-body');
      historicoBody.innerHTML = '';
      
      // Adiciona agendamentos atuais
      agendamentosDoMes.forEach(({ dia, aparelho, professor, turma, numAparelhos, aula, id }) => {
        const row = document.createElement('tr');
        
        const formattedDay = String(dia).padStart(2, '0');
        const formattedMonth = String(parseInt(monthSelect.value) + 1).padStart(2, '0');
        const formattedDate = `${formattedDay}/${formattedMonth}/${yearSelect.value}`;
        
        row.innerHTML = `
          <td>${formattedDate}</td>
          <td>${turma}</td>
          <td>${numAparelhos}</td>
          <td>${aparelho}</td>
          <td>${professor}</td>
          <td>${aula}</td>
          <td><button class="btn btn-excluir" onclick="excluirAgendamento('${id}')">EXCLUIR</button></td>
        `;
        historicoBody.appendChild(row);
      });
      
      // Adiciona agendamentos excluídos (apenas do mês atual)
      const currentMonthKey = `${yearSelect.value}-${String(parseInt(monthSelect.value) + 1).padStart(2, '0')}`;
      historicoExcluidos
        .filter(item => item.mesAno === currentMonthKey)
        .forEach(({ dia, aparelho, professor, turma, numAparelhos, aula }) => {
          const row = document.createElement('tr');
          row.classList.add('excluido');
          
          const formattedDay = String(dia).padStart(2, '0');
          const formattedMonth = String(parseInt(monthSelect.value) + 1).padStart(2, '0');
          const formattedDate = `${formattedDay}/${formattedMonth}/${yearSelect.value}`;
          
          row.innerHTML = `
            <td>${formattedDate}</td>
            <td>${turma}</td>
            <td>${numAparelhos}</td>
            <td>${aparelho}</td>
            <td>${professor}</td>
            <td>${aula}</td>
            <td>EXCLUÍDO</td>
          `;
          historicoBody.appendChild(row);
        });
    }

    function renderCalendarBody(year, month) {
      const calendarBody = document.getElementById('calendarBody');
      calendarBody.innerHTML = '';

      const date = new Date(year, month, 1);
      const firstDay = date.getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();

      const agendamentosDoMes = getAgendamentos(year, month);

      let day = 1;
      let currentRow = document.createElement('tr');
      
      // Ajusta o primeiro dia para começar na segunda-feira (1)
      // Se o primeiro dia do mês for domingo (0), começamos na próxima linha
      let startDay = firstDay === 0 ? 1 : firstDay;
      
      // Cria células vazias para os dias antes do primeiro dia do mês
      for (let i = 1; i < startDay; i++) {
        const emptyCell = document.createElement('td');
        emptyCell.innerHTML = '';
        currentRow.appendChild(emptyCell);
      }

      for (let i = startDay; i <= 5 && day <= daysInMonth; i++) {
        const cell = document.createElement('td');
        cell.textContent = day;

        const agendado = agendamentosDoMes.find(d => d.dia === day);
        if (agendado) {
          cell.classList.add('agendado');
          cell.title = `${agendado.aparelho} - ${agendado.professor}`;
        } else {
          cell.classList.add('disponivel');
          // Remove a possibilidade de clicar diretamente no calendário
          cell.style.cursor = 'default';
        }

        currentRow.appendChild(cell);
        day++;
      }

      calendarBody.appendChild(currentRow);

      // Continua com as outras linhas
      while (day <= daysInMonth) {
        currentRow = document.createElement('tr');
        
        for (let i = 1; i <= 5 && day <= daysInMonth; i++) {
          const cell = document.createElement('td');
          cell.textContent = day;

          const agendado = agendamentosDoMes.find(d => d.dia === day);
          if (agendado) {
            cell.classList.add('agendado');
            cell.title = `${agendado.aparelho} - ${agendado.professor}`;
          } else {
            cell.classList.add('disponivel');
            // Remove a possibilidade de clicar diretamente no calendário
            cell.style.cursor = 'default';
          }

          currentRow.appendChild(cell);
          day++;
        }

        calendarBody.appendChild(currentRow);
      }

      renderHistorico(agendamentosDoMes);
    }

    function gerarIdUnico() {
      return Date.now().toString(36) + Math.random().toString(36).substr(2);
    }

    async function cadastrarAgendamento() {
      const professor = document.getElementById("professor").value;
      const aparelho = document.getElementById("aparelho").value;
      const turma = document.getElementById("studentClass").value;
      const numAparelhos = document.getElementById("numero-aparelhos").value;
      const aula = document.getElementById("aula").value;
      const sala = document.getElementById("sala").value;
      const horaRetirada = document.getElementById("hora-retirada").value;
      const horaEntrega = document.getElementById("hora-entrega").value;
      
      if (!professor || !aparelho || !turma || !numAparelhos || !selectedDate || !sala || !horaRetirada || !horaEntrega) {
        alert("Preencha todos os campos do formulário antes de agendar!");
        return;
      }
      
      // Verifica se já existe agendamento para esta turma, data e aula
      if (verificarConflitoAgendamento(turma, selectedDate, aula)) {
        alert("Já existe um agendamento para esta turma nesta data e aula!");
        return;
      }
      
      const [dia, mes, ano] = selectedDate.split('/');
      const key = `${ano}-${mes}`;
      
      if (!agendamentos[key]) {
        agendamentos[key] = [];
      }
      
      const id = gerarIdUnico();
      
      const novoAgendamento = { 
        id,
        dia: parseInt(dia),
        aparelho,
        professor,
        turma,
        numAparelhos: parseInt(numAparelhos),
        aula,
        sala,
        horaRetirada,
        horaEntrega
      };
      
      agendamentos[key].push(novoAgendamento);
      
      // Atualiza o calendário e o histórico
      renderCalendarBody(parseInt(ano), parseInt(mes) - 1);
      
      // Limpa a seleção
      if (selectedDay) {
        selectedDay.classList.remove('selecionado');
        selectedDay.classList.add('agendado');
        selectedDay = null;
      }
      selectedDate = null;
      document.getElementById('data-selecionada').value = '';
      
      // Gera documento
      await gerarDocumento(novoAgendamento);
      
      alert("Agendamento cadastrado com sucesso!");
    }

    function excluirAgendamento(id) {
      if (!confirm("Tem certeza que deseja excluir este agendamento?")) {
        return;
      }
      
      // Encontra e remove o agendamento
      for (const key in agendamentos) {
        const index = agendamentos[key].findIndex(ag => ag.id === id);
        if (index !== -1) {
          const [agendamentoExcluido] = agendamentos[key].splice(index, 1);
          
          // Adiciona ao histórico de excluídos
          const [ano, mes] = key.split('-');
          historicoExcluidos.push({
            ...agendamentoExcluido,
            mesAno: key
          });
          
          // Atualiza a exibição
          renderCalendarBody(parseInt(ano), parseInt(mes) - 1);
          break;
        }
      }
    }

    async function gerarDocumento(agendamento) {
      try {
        // Esta função seria implementada para integrar com o Google Docs usando o Google Apps Script
        // Aqui está apenas um esboço da implementação que seria chamada pelo Google Apps Script
        
        const response = await fetch('https://script.google.com/macros/s/AKfycbw3I3K5zveoPB398z2EyTfrd91nFmFQr3sspk2E01G8YWS2itYWJ6q7tPicsr-J4U0D/exec', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            action: 'gerarDocumento',
            dados: {
              professor: agendamento.professor,
              quantidade: agendamento.numAparelhos,
              data: agendamento.dia + '/' + (parseInt(monthSelect.value) + 1) + '/' + yearSelect.value,
              tipoAparelho: agendamento.aparelho,
              turma: agendamento.turma,
              aula: agendamento.aula,
              horaRetirada: agendamento.horaRetirada,
              horaEntrega: agendamento.horaEntrega
            }
          })
        });
        
        const result = await response.json();
        
        if (result.success) {
          console.log("Documento gerado com sucesso:", result.url);
        } else {
          console.error("Erro ao gerar documento:", result.message);
        }
      } catch (error) {
        console.error("Erro ao chamar o Google Apps Script:", error);
      }
    }

    function limparFormulario() {
      document.getElementById("professor").value = "Selecione";
      document.getElementById("email-professor").value = "";
      document.getElementById("aparelho").value = "";
      document.getElementById("marca").value = "";
      document.getElementById("numero-aparelhos").value = "1";
      document.getElementById("studentClass").value = "";
      document.getElementById("sala").value = "";
      document.getElementById("hora-retirada").value = "";
      document.getElementById("hora-entrega").value = "";
      document.getElementById("aula").value = "1ª Aula";
      document.getElementById("conflictMessage").style.display = "none";
      
      // Limpa a seleção de data
      if (selectedDay) {
        selectedDay.classList.remove('selecionado');
        const agendamentosDoMes = getAgendamentos(parseInt(yearSelect.value), parseInt(monthSelect.value));
        if (!agendamentosDoMes.find(d => d.dia === parseInt(selectedDay.textContent))) {
          selectedDay.classList.add('disponivel');
        }
        selectedDay = null;
      }
      selectedDate = null;
      document.getElementById('data-selecionada').value = '';
      popupSelectedDate = null;
    }

    // Inicialização
    gerarOpcoesProfessores();
    populateMonthYearSelectors();
    renderCalendarBody(Number(yearSelect.value), Number(monthSelect.value));
    initDatepicker();

    // Adiciona listeners para verificar conflito quando os campos mudam
    document.getElementById("studentClass").addEventListener("change", verificarConflito);
    document.getElementById("aula").addEventListener("change", verificarConflito);
    document.getElementById("data-selecionada").addEventListener("change", verificarConflito);

    monthSelect.addEventListener('change', () => {
      renderCalendarBody(Number(yearSelect.value), Number(monthSelect.value));
    });

    yearSelect.addEventListener('change', () => {
      renderCalendarBody(Number(yearSelect.value), Number(monthSelect.value));
    });
  </script>

  <!-- Código Google Apps Script para ser implementado separadamente -->
  <script>
    // Este código seria implementado no Google Apps Script (separadamente)
    /*
    function doPost(e) {
      const data = JSON.parse(e.postData.contents);
      let response;
      
      if (data.action === 'gerarDocumento') {
        response = gerarDocumentoAgendamento(data.dados);
      } else {
        response = { success: false, message: 'Ação não reconhecida' };
      }
      
      return ContentService.createTextOutput(JSON.stringify(response))
        .setMimeType(ContentService.MimeType.JSON);
    }

    function gerarDocumentoAgendamento(dados) {
      try {
        const modelDocId = "1mQ1s3cbwY3Ok1rb6sf-kVCvXvErNOGjKaP7C5IR7XF4";
        const folderId = "1C-nDUJk8_rBIkebtr1Vv-3yB9C0v87YQ";
        
        // Copia o modelo para um novo documento
        const newDoc = DriveApp.getFileById(modelDocId).makeCopy(
          `Termo de Retirada - ${dados.professor} - ${dados.data}`,
          DriveApp.getFolderById(folderId)
        );
        
        const doc = DocumentApp.openById(newDoc.getId());
        const body = doc.getBody();
        
        // Substitui os placeholders pelos dados reais
        body.replaceText("NOME DO PROFESSOR", dados.professor);
        body.replaceText("QUANTIDADE", dados.quantidade);
        body.replaceText("DATA DE RETIRADA", dados.data);
        
        // Adiciona mais substituições conforme necessário
        body.replaceText("TIPO DE APARELHO", dados.tipoAparelho);
        body.replaceText("TURMA", dados.turma);
        body.replaceText("AULA", dados.aula);
        body.replaceText("HORA RETIRADA", dados.horaRetirada);
        body.replaceText("HORA ENTREGA", dados.horaEntrega);
        
        doc.saveAndClose();
        
        // Converte para PDF
        const pdf = DriveApp.getFileById(newDoc.getId()).getAs('application/pdf');
        const pdfFile = DriveApp.getFolderById(folderId).createFile(pdf);
        pdfFile.setName(`Termo de Retirada - ${dados.professor} - ${dados.data}.pdf`);
        
        // Opcional: exclui o documento DOCX após criar o PDF
        DriveApp.getFileById(newDoc.getId()).setTrashed(true);
        
        return {
          success: true,
          url: pdfFile.getUrl(),
          message: "Documento gerado com sucesso"
        };
      } catch (error) {
        return {
          success: false,
          message: error.toString()
        };
      }
    }
    */
  </script>
</body>
</html>
